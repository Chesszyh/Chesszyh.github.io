
<!DOCTYPE html>

<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Chesszyh's Personal Blog." name="description"/>
<meta content="Chesszyh" name="author"/>
<link href="https://blog.neurosama.uk/posts/Server/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/" rel="canonical"/>
<link href="../../Web/Vue/" rel="prev"/>
<link href="../VPS/self-host-vpn/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.16" name="generator"/>
<title>Cloud Server Config - Chesszyh's Blog</title>
<link href="../../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="purple" data-md-color-primary="deep-purple" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#_1">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="Chesszyh's Blog" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Chesszyh's Blog">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 22H5v-2h14zM13 2c-1.25 0-2.42.62-3.11 1.66L7 8l2 2 2.06-1.37c.44-.31 1.08-.19 1.39.27.02.03.05.06.05.1.3.59.19 1.3-.28 1.77l-4.8 4.8c-.55.56-.55 1.46.01 2.01.26.26.62.42.99.42H17V6a4 4 0 0 0-4-4"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Chesszyh's Blog
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Cloud Server Config
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="purple" data-md-color-media="" data-md-color-primary="deep-purple" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="purple" data-md-color-media="" data-md-color-primary="deep-purple" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<a aria-label="分享" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="分享">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chesszyh" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    Chesszyh
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="标签" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../%E4%B8%BA%E4%BB%80%E4%B9%88%E6%94%BE%E5%BC%83%E6%97%A7%E5%8D%9A%E5%AE%A2/">
          
  
  
    
  
  Posts

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../thoughts/">
          
  
  
    
  
  Thoughts

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../misc/Recently/">
          
  
  
    
  
  Misc

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../summary/2025-08-27/">
          
  
  
    
  
  Summary

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Chesszyh's Blog" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Chesszyh's Blog">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 22H5v-2h14zM13 2c-1.25 0-2.42.62-3.11 1.66L7 8l2 2 2.06-1.37c.44-.31 1.08-.19 1.39.27.02.03.05.06.05.1.3.59.19 1.3-.28 1.77l-4.8 4.8c-.55.56-.55 1.46.01 2.01.26.26.62.42.99.42H17V6a4 4 0 0 0-4-4"></path></svg>
</a>
    Chesszyh's Blog
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chesszyh" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    Chesszyh
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Posts
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Posts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E4%B8%BA%E4%BB%80%E4%B9%88%E6%94%BE%E5%BC%83%E6%97%A7%E5%8D%9A%E5%AE%A2/">
<span class="md-ellipsis">
    Why Abandon Old Blog
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../plugins/">
<span class="md-ellipsis">
    Plugins
    
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            Plugins
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
<span class="md-ellipsis">
    Linux
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            Linux
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Linux/Arch-Linux/">
<span class="md-ellipsis">
    Arch Linux
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Linux/Linux%E5%AE%9E%E8%B7%B5/">
<span class="md-ellipsis">
    Linux Practice
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Linux/WSL/">
<span class="md-ellipsis">
    WSL Usage
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
<span class="md-ellipsis">
    Fedora
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
            Fedora
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Host-Fedora/Intro/">
<span class="md-ellipsis">
    Intro
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Host-Fedora/Setup/">
<span class="md-ellipsis">
    Setup
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Host-Fedora/Swap/">
<span class="md-ellipsis">
    Swap
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Host-Fedora/Problem-shooting/">
<span class="md-ellipsis">
    Problems &amp; Solutions
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
<span class="md-ellipsis">
    Network
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
            Network
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network/CS144-Writeup/">
<span class="md-ellipsis">
    CS144 Writeup
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/">
<span class="md-ellipsis">
    Network Tunneling
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network/%E7%8E%B0%E4%BB%A3%E8%A7%84%E9%81%BF%E5%8D%8F%E8%AE%AE/">
<span class="md-ellipsis">
    Modern Network Protocols
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network/ipv4_6/">
<span class="md-ellipsis">
    IPv4/IPv6
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
<span class="md-ellipsis">
    SoftwareEngineering
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
            SoftwareEngineering
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../SoftwareEngineering/Telegram/">
<span class="md-ellipsis">
    Telegram
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
<span class="md-ellipsis">
    Deployment
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Deployment/github-actions/">
<span class="md-ellipsis">
    GitHub Actions
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../OS/CS162/">
<span class="md-ellipsis">
    OS(CS162)
    
  </span>
</a>
<label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_8">
<span class="md-nav__icon md-icon"></span>
            OS(CS162)
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../OS/CS162/note/lec1/">
<span class="md-ellipsis">
    Lecture 1
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../OS/CS162/note/lec2/">
<span class="md-ellipsis">
    Lecture 2
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../OS/CS162/note/lec3/">
<span class="md-ellipsis">
    Lecture 3
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../OS/CS162/homework/hw0/">
<span class="md-ellipsis">
    HW0
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../OS/CS162/homework/hw1/">
<span class="md-ellipsis">
    HW1
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="">
<span class="md-ellipsis">
    VSCode
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_9">
<span class="md-nav__icon md-icon"></span>
            VSCode
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../VSCode/clangd-cant-find-std-lib/">
<span class="md-ellipsis">
    Clangd Miss std-lib
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="">
<span class="md-ellipsis">
    Web
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_10">
<span class="md-nav__icon md-icon"></span>
            Web
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Web/Javascript/">
<span class="md-ellipsis">
    Javascript
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Web/React/">
<span class="md-ellipsis">
    React
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Web/Vue/">
<span class="md-ellipsis">
    Vue
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="">
<span class="md-ellipsis">
    Server
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_11">
<span class="md-nav__icon md-icon"></span>
            Server
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Cloud Server Config
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Cloud Server Config
    
  </span>
</a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-script">
<span class="md-ellipsis">
      Setup script
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-free-tier">
<span class="md-ellipsis">
      AWS Free Tier
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#storage">
<span class="md-ellipsis">
      Storage
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ssh">
<span class="md-ellipsis">
      SSH
    </span>
</a>
<nav aria-label="SSH" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#connection">
<span class="md-ellipsis">
      Connection
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ssh-issues">
<span class="md-ellipsis">
      SSH Issues
    </span>
</a>
<nav aria-label="SSH Issues" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
<span class="md-ellipsis">
      实例可到达性检查失败
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ssh_1">
<span class="md-ellipsis">
      SSH 连接不稳定
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#network">
<span class="md-ellipsis">
      Network
    </span>
</a>
<nav aria-label="Network" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nodejs">
<span class="md-ellipsis">
      nodejs安装/升级
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#curl">
<span class="md-ellipsis">
      curl配置(主要针对国内服务器)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#git">
<span class="md-ellipsis">
      Git配置(主要针对国内服务器)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shell">
<span class="md-ellipsis">
      Shell
    </span>
</a>
<nav aria-label="Shell" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#zsh">
<span class="md-ellipsis">
      Zsh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copilotvim">
<span class="md-ellipsis">
      copilot.vim
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#language">
<span class="md-ellipsis">
      Language
    </span>
</a>
<nav aria-label="Language" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#uv">
<span class="md-ellipsis">
      uv
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#miniconda">
<span class="md-ellipsis">
      Miniconda
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#docker">
<span class="md-ellipsis">
      Docker
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
<span class="md-ellipsis">
      其他工具
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#security">
<span class="md-ellipsis">
      Security
    </span>
</a>
<nav aria-label="Security" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ssh_2">
<span class="md-ellipsis">
      SSH
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#oom">
<span class="md-ellipsis">
      防止OOM
    </span>
</a>
<nav aria-label="防止OOM" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
<span class="md-ellipsis">
      手动调整
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
<span class="md-ellipsis">
      开源工具
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check">
<span class="md-ellipsis">
      Check
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../VPS/self-host-vpn/">
<span class="md-ellipsis">
    VPS
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Code-server/Code-server/">
<span class="md-ellipsis">
    Code Server
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Nginx/Nginx/">
<span class="md-ellipsis">
    Nginx
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12" id="__nav_2_12_label" tabindex="">
<span class="md-ellipsis">
    VirtualMachine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_12_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_12">
<span class="md-nav__icon md-icon"></span>
            VirtualMachine
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../VirtualMachine/Windows/">
<span class="md-ellipsis">
    Windows
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../VirtualMachine/Network/">
<span class="md-ellipsis">
    Network
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_13" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="">
<span class="md-ellipsis">
    Blog Tech
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_13_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_13">
<span class="md-nav__icon md-icon"></span>
            Blog Tech
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Blog/cusdis-diy/">
<span class="md-ellipsis">
    Cusdis Comment System DIY
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Blog/plugin/">
<span class="md-ellipsis">
    Plugin Development
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_14" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_14" id="__nav_2_14_label" tabindex="">
<span class="md-ellipsis">
    Chess
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_14_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_14">
<span class="md-nav__icon md-icon"></span>
            Chess
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Chess/lichess-bot/">
<span class="md-ellipsis">
    Lichess Bot
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Chess/Stockfish/">
<span class="md-ellipsis">
    Stockfish
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Chess/lc0/">
<span class="md-ellipsis">
    Lc0
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_15" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_15" id="__nav_2_15_label" tabindex="">
<span class="md-ellipsis">
    Database
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_15_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_15">
<span class="md-nav__icon md-icon"></span>
            Database
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Database/DataBase/">
<span class="md-ellipsis">
    Database Learning
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_16" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_16" id="__nav_2_16_label" tabindex="">
<span class="md-ellipsis">
    Docker
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_16_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_16">
<span class="md-nav__icon md-icon"></span>
            Docker
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Docker/Docker%E5%AE%9E%E8%B7%B5/">
<span class="md-ellipsis">
    Docker Practice
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_17" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_17" id="__nav_2_17_label" tabindex="">
<span class="md-ellipsis">
    LLM
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_17_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_17">
<span class="md-nav__icon md-icon"></span>
            LLM
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../LLM/AI-Agent/">
<span class="md-ellipsis">
    AI Agent
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../LLM/DeepSpeed/">
<span class="md-ellipsis">
    DeepSpeed
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../LLM/MCP/">
<span class="md-ellipsis">
    MCP Protocol
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../LLM/open-webui/">
<span class="md-ellipsis">
    Open WebUI
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_18" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_18" id="__nav_2_18_label" tabindex="">
<span class="md-ellipsis">
    Machine-learning
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_18_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_18">
<span class="md-nav__icon md-icon"></span>
            Machine-learning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Machine-learning/TODO/">
<span class="md-ellipsis">
    TODO
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../TODO/">
<span class="md-ellipsis">
    TODO
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../thoughts/">
<span class="md-ellipsis">
    Thoughts
    
  </span>
</a>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Thoughts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../thoughts/Is-vibe-coding-good-for-me/">
<span class="md-ellipsis">
    Is Vibe coding good for me?
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Misc
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../misc/Recently/">
<span class="md-ellipsis">
    Recently Viewed
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../misc/Status/">
<span class="md-ellipsis">
    My status
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../misc/Exploration/">
<span class="md-ellipsis">
    Exploration
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../misc/usb-stick-recovery-and-reformat/">
<span class="md-ellipsis">
    USB Stick Recovery
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../misc/github%E5%AD%A6%E7%94%9F%E9%AA%8C%E8%AF%81%E4%BB%A5%E5%8F%8A%E4%BB%A3%E7%90%86%E9%97%AE%E9%A2%98/">
<span class="md-ellipsis">
    GitHub Student Verification
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../misc/Mermaid/">
<span class="md-ellipsis">
    Mermaid
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Summary
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Summary
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../summary/2025-08-27/">
<span class="md-ellipsis">
    对大学前两年的失败总结
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="_1">云服务器配置<a class="headerlink" href="#_1" title="Permanent link">¶</a></h1>
<p>安装命令主要针对Ubuntu(apt)。Amazon Linux, Fedora(dnf)也会涉及。</p>
<h2 id="setup-script">Setup script<a class="headerlink" href="#setup-script" title="Permanent link">¶</a></h2>
<details>
<summary>Click to expand</summary>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="ch">#!/bin/bash</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="c1"># TODO Better error handling and logging </span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>yellow<span class="o">()</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">"\033[1;33m</span><span class="nv">$*</span><span class="s2">\033[0m"</span><span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="c1"># Normal process</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>green<span class="o">()</span><span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">"\033[1;32m</span><span class="nv">$*</span><span class="s2">\033[0m"</span><span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="c1"># Success message</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>red<span class="o">()</span><span class="w">    </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">"\033[1;31m</span><span class="nv">$*</span><span class="s2">\033[0m"</span><span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="c1"># Error message</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>blue<span class="o">()</span><span class="w">   </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">"\033[1;34m</span><span class="nv">$*</span><span class="s2">\033[0m"</span><span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="c1"># NOTE Info message</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="nb">set</span><span class="w"> </span>-e
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="nb">trap</span><span class="w"> </span><span class="s1">'red "An error occurred, script terminated."'</span><span class="w"> </span>ERR
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>install_zsh<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing zsh and oh-my-zsh..."</span>
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>zsh
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span>chsh<span class="w"> </span>-s<span class="w"> </span><span class="s2">"</span><span class="k">$(</span>which<span class="w"> </span>zsh<span class="k">)</span><span class="s2">"</span>
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">"</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="k">)</span><span class="s2">"</span>
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="c1"># TODO zsh-plugins install failure before</span>
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/zsh-users/zsh-autosuggestions<span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="p">~/.oh-my-zsh/custom</span><span class="si">}</span><span class="s2">"</span>/plugins/zsh-autosuggestions
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/zsh-users/zsh-syntax-highlighting.git<span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="p">~/.oh-my-zsh/custom</span><span class="si">}</span><span class="s2">"</span>/plugins/zsh-syntax-highlighting
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">'s/plugins=(git)/plugins=(git zsh-autosuggestions zsh-syntax-highlighting z)/'</span><span class="w"> </span>~/.zshrc
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"zsh and oh-my-zsh installed successfully."</span>
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="o">}</span>
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a>install_common_tools<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing common tools..."</span>
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>git<span class="w"> </span>curl<span class="w"> </span>wget<span class="w"> </span>build-essential
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="o">}</span>
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a>install_cpp<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing C++ development tools(cmake, clang, gdb...)"</span>
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>cmake<span class="w"> </span>clang<span class="w"> </span>gdb
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">    </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>clangd
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span>sudo<span class="w"> </span>update-alternatives<span class="w"> </span>--install<span class="w"> </span>/usr/bin/clangd<span class="w"> </span>clangd<span class="w"> </span>/usr/bin/clangd-18<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="c1"># 设置clangd为默认</span>
<a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span>ln<span class="w"> </span>-sf<span class="w"> </span>/build/compile_commands.json<span class="w"> </span>.
<a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"C++ development tools installed successfully."</span>
<a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="o">}</span>
<a href="#__codelineno-0-37" id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a href="#__codelineno-0-38" id="__codelineno-0-38" name="__codelineno-0-38"></a>install_python<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-39" id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing Python, pip, miniconda and uv..."</span>
<a href="#__codelineno-0-40" id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3<span class="w"> </span>python3-pip
<a href="#__codelineno-0-41" id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span>wget<span class="w"> </span>https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh<span class="w"> </span>-O<span class="w"> </span>~/miniconda.sh
<a href="#__codelineno-0-42" id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span>chmod<span class="w"> </span>+x<span class="w"> </span>~/miniconda.sh
<a href="#__codelineno-0-43" id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span>bash<span class="w"> </span>~/miniconda.sh<span class="w"> </span>-b<span class="w"> </span>-p<span class="w"> </span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/miniconda"</span>
<a href="#__codelineno-0-44" id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span>rm<span class="w"> </span>~/miniconda.sh
<a href="#__codelineno-0-45" id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/miniconda/bin/conda"</span><span class="w"> </span>init<span class="w"> </span>zsh
<a href="#__codelineno-0-46" id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span>curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
<a href="#__codelineno-0-47" id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"Python, pip, miniconda and uv installed successfully."</span>
<a href="#__codelineno-0-48" id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="o">}</span>
<a href="#__codelineno-0-49" id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a href="#__codelineno-0-50" id="__codelineno-0-50" name="__codelineno-0-50"></a>install_node<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-51" id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing Node.js and npm..."</span>
<a href="#__codelineno-0-52" id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span>curl<span class="w"> </span>-o-<span class="w"> </span>https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
<a href="#__codelineno-0-53" id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">NVM_DIR</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.nvm"</span>
<a href="#__codelineno-0-54" id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">    </span><span class="c1"># shellcheck source=/dev/null</span>
<a href="#__codelineno-0-55" id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="o">[</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">"</span><span class="nv">$NVM_DIR</span><span class="s2">/nvm.sh"</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\.</span><span class="w"> </span><span class="s2">"</span><span class="nv">$NVM_DIR</span><span class="s2">/nvm.sh"</span>
<a href="#__codelineno-0-56" id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="c1"># shellcheck source=/dev/null</span>
<a href="#__codelineno-0-57" id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="o">[</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">"</span><span class="nv">$NVM_DIR</span><span class="s2">/bash_completion"</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\.</span><span class="w"> </span><span class="s2">"</span><span class="nv">$NVM_DIR</span><span class="s2">/bash_completion"</span>
<a href="#__codelineno-0-58" id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span>nvm<span class="w"> </span>install<span class="w"> </span><span class="m">22</span>
<a href="#__codelineno-0-59" id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"Node.js and npm installed successfully."</span>
<a href="#__codelineno-0-60" id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="o">}</span>
<a href="#__codelineno-0-61" id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a href="#__codelineno-0-62" id="__codelineno-0-62" name="__codelineno-0-62"></a>install_rust<span class="o">(){</span>
<a href="#__codelineno-0-63" id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing Rust..."</span>
<a href="#__codelineno-0-64" id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span>curl<span class="w"> </span>--proto<span class="w"> </span><span class="s1">'=https'</span><span class="w"> </span>--tlsv1.2<span class="w"> </span>-sSf<span class="w"> </span>https://sh.rustup.rs<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
<a href="#__codelineno-0-65" id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="nb">source</span><span class="w"> </span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.cargo/env"</span>
<a href="#__codelineno-0-66" id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span>rustup<span class="w"> </span>component<span class="w"> </span>add<span class="w"> </span>rust-analyzer
<a href="#__codelineno-0-67" id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"Rust installed successfully."</span>
<a href="#__codelineno-0-68" id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="o">}</span>
<a href="#__codelineno-0-69" id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a href="#__codelineno-0-70" id="__codelineno-0-70" name="__codelineno-0-70"></a>install_docker<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-71" id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing Docker..."</span>
<a href="#__codelineno-0-72" id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span>pkg<span class="w"> </span><span class="k">in</span><span class="w"> </span>docker.io<span class="w"> </span>docker-doc<span class="w"> </span>docker-compose<span class="w"> </span>docker-compose-v2<span class="w"> </span>podman-docker<span class="w"> </span>containerd<span class="w"> </span>runc<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>remove<span class="w"> </span>-y<span class="w"> </span><span class="nv">$pkg</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<a href="#__codelineno-0-73" id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a href="#__codelineno-0-74" id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>ca-certificates<span class="w"> </span>curl
<a href="#__codelineno-0-75" id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="w">    </span>sudo<span class="w"> </span>install<span class="w"> </span>-m<span class="w"> </span><span class="m">0755</span><span class="w"> </span>-d<span class="w"> </span>/etc/apt/keyrings
<a href="#__codelineno-0-76" id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span>sudo<span class="w"> </span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://download.docker.com/linux/ubuntu/gpg<span class="w"> </span>-o<span class="w"> </span>/etc/apt/keyrings/docker.asc
<a href="#__codelineno-0-77" id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span>sudo<span class="w"> </span>chmod<span class="w"> </span>a+r<span class="w"> </span>/etc/apt/keyrings/docker.asc
<a href="#__codelineno-0-78" id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-79" id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">        </span><span class="s2">"deb [arch=</span><span class="k">$(</span>dpkg<span class="w"> </span>--print-architecture<span class="k">)</span><span class="s2"> signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \</span>
<a href="#__codelineno-0-80" id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="s2">        </span><span class="k">$(</span>.<span class="w"> </span>/etc/os-release<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">UBUNTU_CODENAME</span><span class="k">:-</span><span class="nv">$VERSION_CODENAME</span><span class="si">}</span><span class="s2">"</span><span class="k">)</span><span class="s2"> stable"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-81" id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">        </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/docker.list<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<a href="#__codelineno-0-82" id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a href="#__codelineno-0-83" id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="w">    </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>docker-ce<span class="w"> </span>docker-ce-cli<span class="w"> </span>containerd.io<span class="w"> </span>docker-buildx-plugin<span class="w"> </span>docker-compose-plugin
<a href="#__codelineno-0-84" id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"Docker installed successfully."</span>
<a href="#__codelineno-0-85" id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="o">}</span>
<a href="#__codelineno-0-86" id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a href="#__codelineno-0-87" id="__codelineno-0-87" name="__codelineno-0-87"></a>install_yazi<span class="o">(){</span>
<a href="#__codelineno-0-88" id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing yazi with optional dependencies..."</span>
<a href="#__codelineno-0-89" id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"You can choose to skip some optional dependencies if you don't need them."</span>
<a href="#__codelineno-0-90" id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ffmpeg<span class="w"> </span>7zip<span class="w"> </span>jq<span class="w"> </span>poppler-utils<span class="w"> </span>fd-find<span class="w"> </span>ripgrep<span class="w"> </span>fzf<span class="w"> </span>zoxide<span class="w"> </span>imagemagick
<a href="#__codelineno-0-91" id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span>blue<span class="w"> </span><span class="s2">"yazi doesn't have a official deb release, so you need to build from source or install from snap."</span>
<a href="#__codelineno-0-92" id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a href="#__codelineno-0-93" id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="c1"># NOTE Building process may be killed in low memory environment</span>
<a href="#__codelineno-0-94" id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing from snap(1), build from source(2,need rust) or cancel(3)"</span>
<a href="#__codelineno-0-95" id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">    </span><span class="nb">read</span><span class="w"> </span>-rp<span class="w"> </span><span class="s2">"Enter your choice [1-3]: "</span><span class="w"> </span>choice
<a href="#__codelineno-0-96" id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$choice</span><span class="s2">"</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-97" id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">        </span>sudo<span class="w"> </span>snap<span class="w"> </span>install<span class="w"> </span>yazi<span class="w"> </span>--classic
<a href="#__codelineno-0-98" id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$choice</span><span class="s2">"</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-99" id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">        </span>git<span class="w"> </span>clone<span class="w"> </span>--depth<span class="o">=</span><span class="m">1</span><span class="w"> </span>https://github.com/sxyazi/yazi.git
<a href="#__codelineno-0-100" id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">        </span><span class="nb">cd</span><span class="w"> </span>yazi
<a href="#__codelineno-0-101" id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="w">        </span><span class="c1"># Check if cargo is installed</span>
<a href="#__codelineno-0-102" id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>cargo<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-103" id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">        </span>install_rust
<a href="#__codelineno-0-104" id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="w">        </span><span class="k">fi</span>
<a href="#__codelineno-0-105" id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">        </span>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>--locked
<a href="#__codelineno-0-106" id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="w">        </span>mv<span class="w"> </span>target/release/yazi<span class="w"> </span>target/release/ya<span class="w"> </span>/usr/local/bin/
<a href="#__codelineno-0-107" id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$choice</span><span class="s2">"</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-108" id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="w">        </span>yellow<span class="w"> </span><span class="s2">"Installation cancelled."</span>
<a href="#__codelineno-0-109" id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="w">    </span><span class="k">fi</span>
<a href="#__codelineno-0-110" id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="o">}</span>
<a href="#__codelineno-0-111" id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a href="#__codelineno-0-112" id="__codelineno-0-112" name="__codelineno-0-112"></a>install_custom_tools<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-0-113" id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Installing custom tools..."</span>
<a href="#__codelineno-0-114" id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="w">    </span><span class="nv">CHOICES</span><span class="o">=</span><span class="k">$(</span>whiptail<span class="w"> </span>--title<span class="w"> </span><span class="s2">"Custom Tools Installation Options"</span><span class="w"> </span>--checklist<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-115" id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="w">    </span><span class="s2">"Select custom tools to install (space to select, Tab to switch, Enter to confirm):"</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-116" id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="s2">"htop"</span><span class="w"> </span><span class="s2">"Interactive process viewer"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-117" id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="w">    </span><span class="s2">"btop"</span><span class="w"> </span><span class="s2">"All-in-one resource monitor"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-118" id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="w">    </span><span class="s2">"fastfetch"</span><span class="w"> </span><span class="s2">"Fast system information display tool"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-119" id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">    </span><span class="s2">"ncdu"</span><span class="w"> </span><span class="s2">"Disk usage analyzer"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-120" id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="s2">"tree"</span><span class="w"> </span><span class="s2">"Directory tree viewer"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-121" id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="w">    </span><span class="s2">"bat"</span><span class="w"> </span><span class="s2">"Cat clone with syntax highlighting"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-122" id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="s2">"yazi"</span><span class="w"> </span><span class="s2">"Command-line file manager"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-123" id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="w">    </span><span class="m">3</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">3</span><span class="k">)</span>
<a href="#__codelineno-0-124" id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a href="#__codelineno-0-125" id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">"</span><span class="nv">$CHOICES</span><span class="s2">"</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-126" id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">        </span>yellow<span class="w"> </span><span class="s2">"No tools selected or menu cancelled."</span>
<a href="#__codelineno-0-127" id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="w">        </span><span class="k">return</span>
<a href="#__codelineno-0-128" id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">    </span><span class="k">fi</span>
<a href="#__codelineno-0-129" id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a href="#__codelineno-0-130" id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"Selected choices: </span><span class="nv">$CHOICES</span><span class="s2">"</span>
<a href="#__codelineno-0-131" id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a href="#__codelineno-0-132" id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="c1"># 将 whiptail 返回的带引号字段解析为数组（保留每个选项里的空格）</span>
<a href="#__codelineno-0-133" id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">    </span><span class="c1"># TODO fix this</span>
<a href="#__codelineno-0-134" id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">    </span><span class="nv">parsed_choices</span><span class="o">=(</span><span class="s2">"</span><span class="nv">$CHOICES</span><span class="s2">"</span><span class="o">)</span>
<a href="#__codelineno-0-135" id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a href="#__codelineno-0-136" id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span>choice<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">parsed_choices</span><span class="p">[@]</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a href="#__codelineno-0-137" id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">"</span><span class="nv">$choice</span><span class="s2">"</span><span class="w"> </span><span class="k">in</span>
<a href="#__codelineno-0-138" id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="w">            </span><span class="se">\"</span>htop<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>htop<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-139" id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="w">            </span><span class="se">\"</span>btop<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>btop<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-140" id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">            </span><span class="se">\"</span>fastfetch<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>fastfetch<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-141" id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="w">            </span><span class="se">\"</span>ncdu<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>ncdu<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-142" id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">            </span><span class="se">\"</span>tree<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>tree<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-143" id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">            </span><span class="se">\"</span>bat<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>bat<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-144" id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">            </span><span class="se">\"</span>yazi<span class="se">\"</span><span class="w"> </span><span class="o">)</span><span class="w"> </span>install_yazi<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-145" id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="w">        </span><span class="k">esac</span>
<a href="#__codelineno-0-146" id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="w">    </span><span class="k">done</span>
<a href="#__codelineno-0-147" id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a href="#__codelineno-0-148" id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span>green<span class="w"> </span><span class="s2">"Custom tools installed successfully."</span>
<a href="#__codelineno-0-149" id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="o">}</span>
<a href="#__codelineno-0-150" id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a href="#__codelineno-0-151" id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="c1"># Test mode using Docker</span>
<a href="#__codelineno-0-152" id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"test"</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-153" id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="w">    </span><span class="nv">SCRIPT_DIR</span><span class="o">=</span><span class="k">$(</span><span class="nb">cd</span><span class="w"> </span><span class="s2">"</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">"</span><span class="nv">$0</span><span class="s2">"</span><span class="k">)</span><span class="s2">"</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">pwd</span><span class="k">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span>
<a href="#__codelineno-0-154" id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="w">    </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-155" id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">        </span>-v<span class="w"> </span><span class="s2">"</span><span class="nv">$SCRIPT_DIR</span><span class="s2">"</span>:/workspace<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-156" id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">        </span>--name<span class="w"> </span>ubuntu-init-test<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-157" id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="w">        </span>ubuntu:22.04<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-158" id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="w">        </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">"apt update &amp;&amp; apt install -y sudo curl git wget build-essential whiptail &amp;&amp; cd /workspace &amp;&amp; bash ubuntu-init.sh"</span>
<a href="#__codelineno-0-159" id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a href="#__codelineno-0-160" id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">    </span>yellow<span class="w"> </span><span class="s2">"Enter the Docker container?"</span>
<a href="#__codelineno-0-161" id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">    </span><span class="nb">read</span><span class="w"> </span>-rp<span class="w"> </span><span class="s2">"(y/n): "</span><span class="w"> </span>answer
<a href="#__codelineno-0-162" id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$answer</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span>Yy<span class="o">]</span>$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a href="#__codelineno-0-163" id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="w">        </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>ubuntu-init-test<span class="w"> </span>zsh
<a href="#__codelineno-0-164" id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="k">fi</span>
<a href="#__codelineno-0-165" id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<a href="#__codelineno-0-166" id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="k">fi</span>
<a href="#__codelineno-0-167" id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a href="#__codelineno-0-168" id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="c1"># SCRIPT STARTS HERE</span>
<a href="#__codelineno-0-169" id="__codelineno-0-169" name="__codelineno-0-169"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a href="#__codelineno-0-170" id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a href="#__codelineno-0-171" id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="c1"># whiptail multi-select menu</span>
<a href="#__codelineno-0-172" id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="nv">CHOICES</span><span class="o">=</span><span class="k">$(</span>whiptail<span class="w"> </span>--title<span class="w"> </span><span class="s2">"Development Environment Installation Options"</span><span class="w"> </span>--checklist<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-173" id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="s2">"Select components to install (space to select, Tab to switch, Enter to confirm):"</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-174" id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="s2">"zsh"</span><span class="w"> </span><span class="s2">"zsh/oh-my-zsh/zsh plugins"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-175" id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="s2">"common"</span><span class="w"> </span><span class="s2">"Common tools (git/curl/wget/build-essential)"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-176" id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="s2">"cpp"</span><span class="w"> </span><span class="s2">"C++ (cmake/clang/gdb)"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-177" id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="s2">"python"</span><span class="w"> </span><span class="s2">"Python/pip/Miniconda/uv"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-178" id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="s2">"node"</span><span class="w"> </span><span class="s2">"Node.js/npm/nvm"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-179" id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="s2">"rust"</span><span class="w"> </span><span class="s2">"Rust/rust-analyzer"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-180" id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="s2">"docker"</span><span class="w"> </span><span class="s2">"Docker"</span><span class="w"> </span>OFF<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-181" id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="s2">"custom"</span><span class="w"> </span><span class="s2">"Custom tools"</span><span class="w"> </span>ON<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-0-182" id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="m">3</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">3</span><span class="k">)</span>
<a href="#__codelineno-0-183" id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a href="#__codelineno-0-184" id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="k">for</span><span class="w"> </span>choice<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$CHOICES</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a href="#__codelineno-0-185" id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nv">$choice</span><span class="w"> </span><span class="k">in</span>
<a href="#__codelineno-0-186" id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">        </span><span class="se">\"</span>zsh<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_zsh<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-187" id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="w">        </span><span class="se">\"</span>common<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_common_tools<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-188" id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="w">        </span><span class="se">\"</span>cpp<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_cpp<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-189" id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="w">        </span><span class="se">\"</span>python<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_python<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-190" id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="w">        </span><span class="se">\"</span>node<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_node<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-191" id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="w">        </span><span class="se">\"</span>docker<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_docker<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-192" id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="w">        </span><span class="se">\"</span>custom<span class="se">\"</span><span class="o">)</span><span class="w"> </span>install_custom_tools<span class="w"> </span><span class="p">;;</span>
<a href="#__codelineno-0-193" id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="k">esac</span>
<a href="#__codelineno-0-194" id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="k">done</span>
</code></pre></div>
</details>
<h2 id="aws-free-tier">AWS Free Tier<a class="headerlink" href="#aws-free-tier" title="Permanent link">¶</a></h2>
<p>AWS提供了：</p>
<ol>
<li>12个月的EC2</li>
<li>3个月的VPS</li>
</ol>
<p><a href="https://aws.amazon.com/cn/rds/free/?loc=ft#Free_Tier">参考</a></p>
<h2 id="storage">Storage<a class="headerlink" href="#storage" title="Permanent link">¶</a></h2>
<blockquote>
<p>AWS免费额度：在开设 AWS 账户的第一年，与免费套餐 AMI、每月 750 小时的公有 IPv4 地址用量、30 GiB 的 EBS 存储、200 万个 I/O、1 GB 快照和 100 GB 互联网带宽一起使用时，您每月可获得 750 小时的 t2.micro 实例用量（如果没有 t2.micro，则使用 t3.micro）。</p>
</blockquote>
<p>默认磁盘空间8G实在是太少了，想扩容发现控制台页面有点看不懂，参考了一下YouTube视频：<a href="https://www.youtube.com/watch?v=jVffXZc4tf8">How to increase EBS volume size in AWS EC2</a>，该视频主要参考了<a href="https://docs.aws.amazon.com/ebs/latest/userguide/recognize-expanded-volume-linux.html">AWS的官方文档</a>。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># 安装必要的工具</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>cloud-guest-utils<span class="w"> </span>gdisk<span class="w"> </span>-y<span class="w">   </span><span class="c1"># Ubuntu/Debian</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1"># 扩展分区</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>sudo<span class="w"> </span>growpart<span class="w"> </span>/dev/xvda<span class="w"> </span><span class="m">1</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1"># 扩展文件系统</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>sudo<span class="w"> </span>resize2fs<span class="w"> </span>/dev/xvda1<span class="w">   </span><span class="c1"># 对于 ext4</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="c1"># 或</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>sudo<span class="w"> </span>xfs_growfs<span class="w"> </span>/<span class="w">          </span><span class="c1"># 对于 xfs</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="c1"># 验证扩展结果</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a>df<span class="w"> </span>-h
</code></pre></div>
<h2 id="ssh">SSH<a class="headerlink" href="#ssh" title="Permanent link">¶</a></h2>
<h3 id="connection">Connection<a class="headerlink" href="#connection" title="Permanent link">¶</a></h3>
<p>通常我使用<code>ssh -i "AWS-Cloudserver.pem" ubuntu@ec2-3-14-128-59.us-east-2.compute.amazonaws.com</code>，自动登录到ubuntu普通用户。</p>
<p>AWS提供了四种连接方式，我懒得去深入了解，就让AI简单解释了一下：</p>
<ol>
<li>EC2 Instance Connect：基于浏览器的 SSH 连接方式，使用使用临时SSH密钥，自动管理</li>
<li>Session Manager：高安全性，通过 <code>AWS Systems Manager</code> 控制台连接到实例，无需暴露22端口，默认似乎没有安装SSM Agent</li>
<li>SSH密钥对：开放22端口，管理好本地私钥就好</li>
<li>EC2 串行控制台：低级别系统访问，通常用于系统启动失败、网络配置错误等紧急故障排除的情景</li>
</ol>
<p><code>AWS-Cloudserver.pem</code>密钥文件，我在WSL2的<code>/root/</code>下放了一份，又在<code>/mnt/d/下载</code>放了一份，但是在Windows上使用PEM文件连接时报错：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>@<span class="w">         </span>WARNING:<span class="w"> </span>UNPROTECTED<span class="w"> </span>PRIVATE<span class="w"> </span>KEY<span class="w"> </span>FILE!<span class="w">          </span>@
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>Permissions<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">'AWS-Cloudserver.pem'</span><span class="w"> </span>are<span class="w"> </span>too<span class="w"> </span>open.
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>It<span class="w"> </span>is<span class="w"> </span>required<span class="w"> </span>that<span class="w"> </span>your<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>files<span class="w"> </span>are<span class="w"> </span>NOT<span class="w"> </span>accessible<span class="w"> </span>by<span class="w"> </span>others.
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>This<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>ignored.
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>Load<span class="w"> </span>key<span class="w"> </span><span class="s2">"AWS-Cloudserver.pem"</span>:<span class="w"> </span>bad<span class="w"> </span>permissions
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>ubuntu@ec2-3-14-128-59.us-east-2.compute.amazonaws.com:<span class="w"> </span>Permission<span class="w"> </span>denied<span class="w"> </span><span class="o">(</span>publickey<span class="o">)</span>.
</code></pre></div>
<p>还挺智能，电脑居然能检测到我把密钥放在这里不安全(确实是不安全，以后不犯懒了hh)因此拒绝连接，设置为仅当前用户可访问即可：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">icacls</span> <span class="s2">"D:\下载\AWS-Cloudserver.pem"</span> <span class="p">/</span><span class="n">inheritance</span><span class="p">:</span><span class="nb">r</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="n">icacls</span> <span class="s2">"D:\下载\AWS-Cloudserver.pem"</span> <span class="p">/</span><span class="n">grant</span><span class="p">:</span><span class="nb">r </span><span class="s2">"</span><span class="p">$(</span><span class="nv">$env:USERNAME</span><span class="p">)</span><span class="s2">:(R,W)"</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="c"># 或者chmod 600：只有文件所有者有读写权限</span>
</code></pre></div>
<p>连接保持：</p>
<p>本机电脑意外锁屏后会导致SSH掉线，因此需要在本机/服务器上设置SSH保持连接。</p>
<p><strong>本机</strong>：在<code>~/.ssh/config</code>中添加以下内容，设置<code>ServerAliveInterval</code>表示每隔60秒向服务器发送一个心跳包，<code>ServerAliveCountMax</code>表示如果连续5次没有收到服务器的响应，则断开连接。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>Host<span class="w"> </span>*
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">    </span>ServerAliveInterval<span class="w"> </span><span class="m">60</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span>ServerAliveCountMax<span class="w"> </span><span class="m">5</span>
</code></pre></div>
<p><strong>服务器</strong>：在<code>/etc/ssh/sshd_config</code>中添加/修改/解除同样内容注释，然后重启SSH服务：<code>sudo systemctl restart sshd</code>。</p>
<h3 id="ssh-issues">SSH Issues<a class="headerlink" href="#ssh-issues" title="Permanent link">¶</a></h3>
<h4 id="_2">实例可到达性检查失败<a class="headerlink" href="#_2" title="Permanent link">¶</a></h4>
<p>前天开始，AWS的ssh一直连不上去，不管是EC2 Instance Connect还是直接ssh。文档翻了一堆，入站规则也检查了半天，系统日志也翻了，都没看到问题。我SSH是免密登录+0.0.0.0/0开放访问，猜测可能是端口被大流量扫死了？但是监控里又显示只有非常短的一段时间内CPU占用是100%，那段时间好像我在用服务器，总之这个也不太可能。</p>
<p>今天换了台AWS服务器，还是登不上去，猜测是国内网络问题或者AWS哪里没配置对，就租了台阿里云服务器，结果非常顺利地就连上去了。对比两台服务器的配置，最终才发现问题：<strong>Aliyun和AWS侧边导航栏定义的“安全组”是针对全局的，每个服务器必须手动绑定到特定的规则上，才能应用出入站规则。</strong>我AWS的服务器只绑定了默认允许所有HTTPS流量进站的规则，没绑定SSH，所以当然连不上去了。</p>
<p>挺蠢的问题，但还好没困扰太长时间，也就几个小时吧hh。</p>
<h4 id="ssh_1">SSH 连接不稳定<a class="headerlink" href="#ssh_1" title="Permanent link">¶</a></h4>
<p>将以上配置改好之后，依然会出现SSH老是断线/根本连不上的问题。不像是网络的事，而是服务器性能太差、open-webui-docker占用CPU负载过高导致SSH直接挂掉的。</p>
<p>之前我用阿里云2核2G服务器试着启动过open-webui的服务，结果也是直接卡死。刚才新租了一个AWS服务器，什么服务都没启动，秒连。</p>
<h2 id="network">Network<a class="headerlink" href="#network" title="Permanent link">¶</a></h2>
<h3 id="nodejs">nodejs安装/升级<a class="headerlink" href="#nodejs" title="Permanent link">¶</a></h3>
<p>通过<code>nvm</code>(Node Version Manager)安装。nvm可以在多个不同nodejs版本之间切换，便于管理项目。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>curl<span class="w"> </span>-o-<span class="w"> </span>https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="nb">source</span><span class="w"> </span>~/.zshrc<span class="w"> </span><span class="c1"># or ~/.bashrc</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>nvm<span class="w"> </span>--version
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>nvm<span class="w"> </span>install<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="c1"># or nvm install node</span>
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a>nvm<span class="w"> </span>use<span class="w"> </span><span class="m">20</span><span class="w">   </span><span class="c1"># or nvm use node</span>
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a>node<span class="w"> </span>-v
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1"># 如有需要。继续安装pnpm</span>
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>pnpm
</code></pre></div>
<h3 id="curl">curl配置(主要针对国内服务器)<a class="headerlink" href="#curl" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1"># 33331是系统自动分配的端口</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="o">(</span>base<span class="o">)</span><span class="w"> </span>chesszyh@chesszyh-ThinkPad-X270:~/Develop$<span class="w"> </span>curl<span class="w"> </span>http://127.0.0.1:33331/commands/pac
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="k">function</span><span class="w"> </span>FindProxyForURL<span class="o">(</span>url,<span class="w"> </span>host<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s2">"PROXY 127.0.0.1:7897; SOCKS5 127.0.0.1:7897; DIRECT;"</span><span class="p">;</span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="o">}</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="c1"># 但是，http_proxy和https_proxy并不能用当前的33331，否则结果如下：</span>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="o">(</span>base<span class="o">)</span><span class="w"> </span>chesszyh@chesszyh-ThinkPad-X270:~/Develop$<span class="w"> </span>./uv-installer.sh
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>downloading<span class="w"> </span>uv<span class="w"> </span><span class="m">0</span>.6.10<span class="w"> </span>x86_64-unknown-linux-gnu
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>curl:<span class="w"> </span><span class="o">(</span><span class="m">22</span><span class="o">)</span><span class="w"> </span>The<span class="w"> </span>requested<span class="w"> </span>URL<span class="w"> </span>returned<span class="w"> </span>error:<span class="w"> </span><span class="m">404</span>
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a>failed<span class="w"> </span>to<span class="w"> </span>download<span class="w"> </span>https://github.com/astral-sh/uv/releases/download/0.6.10/uv-x86_64-unknown-linux-gnu.tar.gz
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a>this<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>a<span class="w"> </span>standard<span class="w"> </span>network<span class="w"> </span>error,<span class="w"> </span>but<span class="w"> </span>it<span class="w"> </span>may<span class="w"> </span>also<span class="w"> </span>indicate
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>that<span class="w"> </span>uv<span class="err">'</span>s<span class="w"> </span>release<span class="w"> </span>process<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>working.<span class="w"> </span>When<span class="w"> </span><span class="k">in</span><span class="w"> </span>doubt
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a>please<span class="w"> </span>feel<span class="w"> </span>free<span class="w"> </span>to<span class="w"> </span>open<span class="w"> </span>an<span class="w"> </span>issue!
<a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a>
<a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="c1"># 查看33331端口输出的7897实际端口</span>
<a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="o">(</span>base<span class="o">)</span><span class="w"> </span>chesszyh@chesszyh-ThinkPad-X270:~/Develop$<span class="w"> </span>netstat<span class="w"> </span>-tuln<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">7897</span>
<a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a>tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:7897<span class="w">          </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN
<a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a>udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:7897<span class="w">          </span><span class="m">0</span>.0.0.0:*
<a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a>
<a href="#__codelineno-6-21" id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="c1"># 用7897端口</span>
<a href="#__codelineno-6-22" id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="o">(</span>base<span class="o">)</span><span class="w"> </span>chesszyh@chesszyh-ThinkPad-X270:~/Develop$
<a href="#__codelineno-6-23" id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="nb">export</span><span class="w"> </span><span class="nv">http_proxy</span><span class="o">=</span><span class="s2">"http://127.0.0.1:7897"</span>
<a href="#__codelineno-6-24" id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="nb">export</span><span class="w"> </span><span class="nv">https_proxy</span><span class="o">=</span><span class="s2">"http://127.0.0.1:7897"</span>
<a href="#__codelineno-6-25" id="__codelineno-6-25" name="__codelineno-6-25"></a>
<a href="#__codelineno-6-26" id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="c1"># 再次尝试curl，可以看到下载成功</span>
</code></pre></div>
<h3 id="git">Git配置(主要针对国内服务器)<a class="headerlink" href="#git" title="Permanent link">¶</a></h3>
<p>修改<code>~/.ssh/config</code>文件，添加如下内容：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>Host<span class="w"> </span>github.com
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span>User<span class="w"> </span>git
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">  </span>Hostname<span class="w"> </span>ssh.github.com
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">  </span>Port<span class="w"> </span><span class="m">443</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">  </span>TCPKeepAlive<span class="w"> </span>yes
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">  </span>IdentitiesOnly<span class="w"> </span>yes
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">  </span>ServerAliveInterval<span class="w"> </span><span class="m">60</span>
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">  </span>ServerAliveCountMax<span class="w"> </span><span class="m">30</span>
</code></pre></div>
<h2 id="shell">Shell<a class="headerlink" href="#shell" title="Permanent link">¶</a></h2>
<h3 id="zsh">Zsh<a class="headerlink" href="#zsh" title="Permanent link">¶</a></h3>
<p>之前安装的是fish，但fish似乎不太兼容bash语法，所以就换成了zsh。fish安装：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>sudo<span class="w"> </span>apt-add-repository<span class="w"> </span>ppa:fish-shell/release-4
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>fish
</code></pre></div>
<ul>
<li>Zsh配置参考：</li>
<li><a href="https://www.hackerneo.com/blog/dev-tools/better-use-terminal-with-zsh">zsh</a></li>
</ul>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1"># Zsh</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="c1"># 安装git(Amazon Linux需要)</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>-y
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="c1"># zsh</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>zsh<span class="w"> </span><span class="c1"># or sudo yum install zsh</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="c1"># oh-my-zsh</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">"</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="k">)</span><span class="s2">"</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="c1"># 下载主题：[powerlevel10k](https://github.com/romkatv/powerlevel10k)</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>git<span class="w"> </span>clone<span class="w"> </span>--depth<span class="o">=</span><span class="m">1</span><span class="w"> </span>https://github.com/romkatv/powerlevel10k.git<span class="w"> </span><span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="nv">$HOME</span><span class="p">/.oh-my-zsh/custom</span><span class="si">}</span>/themes/powerlevel10k
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="c1"># 安装插件：autosuggestions, syntax-highlighting, z(文件夹快捷跳转)</span>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/zsh-users/zsh-autosuggestions<span class="w"> </span><span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="p">~/.oh-my-zsh/custom</span><span class="si">}</span>/plugins/zsh-autosuggestions
<a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/zsh-users/zsh-syntax-highlighting.git<span class="w"> </span><span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="p">~/.oh-my-zsh/custom</span><span class="si">}</span>/plugins/zsh-syntax-highlighting
<a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a>
<a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="c1"># 修改~/.zshrc文件中的ZSH_THEME和plugins</span>
<a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a>vim<span class="w"> </span>~/.zshrc
<a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="nv">ZSH_THEME</span><span class="o">=</span><span class="s2">"powerlevel10k/powerlevel10k"</span>
<a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="nv">plugins</span><span class="o">=(</span>
<a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="w">    </span>git
<a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="w">    </span>zsh-autosuggestions
<a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="w">    </span>zsh-syntax-highlighting
<a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="w">    </span>z
<a href="#__codelineno-9-25" id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="o">)</span>
<a href="#__codelineno-9-26" id="__codelineno-9-26" name="__codelineno-9-26"></a>
<a href="#__codelineno-9-27" id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="c1"># 使修改生效，同时开始自动配置powerlevel10k</span>
<a href="#__codelineno-9-28" id="__codelineno-9-28" name="__codelineno-9-28"></a><span class="nb">source</span><span class="w"> </span>~/.zshrc
</code></pre></div>
<h3 id="copilotvim"><a href="https://github.com/github/copilot.vim">copilot.vim</a><a class="headerlink" href="#copilotvim" title="Permanent link">¶</a></h3>
<p>Copilot.vim需要：</p>
<p>Nodejs 20.x or Later</p>
<p>Vim 9+</p>
<p>Amazon Linux默认yum下来的nodejs</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1"># 安装unzip(如果没有)</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>unzip
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="c1"># 安装nodejs</span>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nodejs<span class="w"> </span>npm
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="c1"># 或者安装fnm</span>
<a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="c1"># curl -o- https://fnm.vercel.app/install | zsh</span>
<a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="c1"># source ~/.zshrc</span>
<a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="c1"># 然后使用 fnm 安装 Node.js</span>
<a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="c1"># fnm install 16  # 安装 Node.js 16 (Copilot 兼容版本)</span>
<a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="c1"># fnm use 16</span>
<a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a>
<a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="c1"># 安装copilot.vim</span>
<a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/github/copilot.vim.git<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-10-15" id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">  </span>~/.vim/pack/github/start/copilot.vim
<a href="#__codelineno-10-16" id="__codelineno-10-16" name="__codelineno-10-16"></a>
<a href="#__codelineno-10-17" id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="c1"># Start Vim/Neovim and invoke :Copilot setup</span>
</code></pre></div>
<h2 id="language">Language<a class="headerlink" href="#language" title="Permanent link">¶</a></h2>
<h3 id="uv"><a href="https://docs.astral.sh/uv/getting-started/">uv</a><a class="headerlink" href="#uv" title="Permanent link">¶</a></h3>
<p>uv：先进的Python虚拟环境管理器，很像Rust的Cargo。</p>
<ul>
<li>Python自带venv：共享解释器，我不是很喜欢这个方案，除非conda出现问题用不了</li>
<li><em>之前WSL2-Ubuntu创建conda虚拟环境后直接pip安装，会报PEP668(禁止在全局base环境下执行pip安装)的错，<code>which pip</code>显示的是系统而非conda虚拟环境的pip，猜测可能是<code>conda init</code>时有问题，后续也不知道怎么就解决了</em></li>
<li>conda隔离性更好，每个虚拟环境有自己的独立解释器，ML和DL常用</li>
</ul>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="nb">source</span><span class="w"> </span>~/.zshrc
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="c1"># 创建指定 Python 版本的虚拟环境</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>uv<span class="w"> </span>venv<span class="w"> </span>-p<span class="w"> </span>python3.11<span class="w"> </span>./venv
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="nb">source</span><span class="w"> </span>./venv/bin/activate
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a>uv<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="o">[</span>package<span class="o">]</span>
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a>uv<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="c1"># 取消激活虚拟环境</span>
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a>deactivate
</code></pre></div>
<h3 id="miniconda"><a href="https://www.anaconda.com/docs/getting-started/miniconda/install">Miniconda</a><a class="headerlink" href="#miniconda" title="Permanent link">¶</a></h3>
<p><a href="https://www.anaconda.com/products/individual">Anaconda</a>自带大量数据科学库（pandas, numpy, scipy, scikit-learn等），体积比较大，服务器存储空间有限时一般用Miniconda。</p>
<p>如果通过curl/wget等下载脚本有各种网络问题时，也可以手动下载后上传到服务器，不过手动上传的文件需要注意<code>chmod +x</code>。我在国内的电脑和服务器，git https协议pull不下来也push不上去，只能用ssh；ping github也ping不通，curl更是几乎没成功过。国外的AWS服务器，git clone简直就是秒下，流畅性差距简直不是一般的大。</p>
<p>Miniconda安装脚本是一个<strong>自解压可执行脚本</strong>，它包含:</p>
<ol>
<li>一个文本shell脚本部分：执行逻辑，以及用户协议等</li>
<li>一个附加的二进制数据部分(包含实际的安装文件)</li>
</ol>
<blockquote>
<p>我第一次下载脚本时，一看<code>.sh</code>文件居然266MB，用Emeditor和Notepad++打开都有乱码(二进制数据)，试图用<code>dos2unix</code>将LF转为CRLF也会报错：<code>unix2dos: Binary symbol 0x02 found at line 670 \n unix2dos: Skipping binary file</code></p>
</blockquote>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="c1"># 下载</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>wget<span class="w"> </span>https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
</code></pre></div>
<h2 id="docker">Docker<a class="headerlink" href="#docker" title="Permanent link">¶</a></h2>
<p>参考这篇文章：<a href="../../Docker/Docker%E5%AE%9E%E8%B7%B5/">Dcoker</a>。</p>
<h2 id="_3">其他工具<a class="headerlink" href="#_3" title="Permanent link">¶</a></h2>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># ncdu: headless下磁盘空间占用查看，类似Windows的WiZTree</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ncdu
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="c1"># Amazon Linux2023 未提供官方包，因此需要手动下载，参考：https://github.com/amazonlinux/amazon-linux-2023/issues/485</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a>wget<span class="w"> </span>http://packages.eu-central-1.amazonaws.com/2018.03/main/c31535f74c6e/x86_64/Packages/ncdu-1.10-1.3.amzn1.x86_64.rpm
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>ncdu-1.10-1.3.amzn1.x86_64.rpm
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="c1"># [bat](https://github.com/sharkdp/bat): cat的替代品，带有语法高亮和Git集成</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>bat
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="c1"># 设置别名</span>
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>~/.local/bin
<a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a>ln<span class="w"> </span>-s<span class="w"> </span>/usr/bin/batcat<span class="w"> </span>~/.local/bin/bat
<a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a>
<a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="c1"># thefuck：命令拼写错误自动修正</span>
<a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="c1"># 例：puthon main.py -&gt; fuck -&gt; python main.py -&gt; Enter</span>
<a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="c1"># 这个仓库的依赖最近出现了一些问题，修复的PR还没merge进来</span>
<a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="c1"># pip install thefuck</span>
</code></pre></div>
<h2 id="security">Security<a class="headerlink" href="#security" title="Permanent link">¶</a></h2>
<h3 id="ssh_2">SSH<a class="headerlink" href="#ssh_2" title="Permanent link">¶</a></h3>
<ul>
<li><a href="https://github.com/fail2ban/fail2ban">Fail2ban</a></li>
<li>我的配置主要参考<a href="https://zhuanlan.zhihu.com/p/528392777">https://zhuanlan.zhihu.com/p/528392777</a></li>
</ul>
<h3 id="oom">防止OOM<a class="headerlink" href="#oom" title="Permanent link">¶</a></h3>
<h4 id="_4">手动调整<a class="headerlink" href="#_4" title="Permanent link">¶</a></h4>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="c1"># 1. 添加交换分区(一般将swap设置为内存的1-2倍)</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>sudo<span class="w"> </span>fallocate<span class="w"> </span>-l<span class="w"> </span>2G<span class="w"> </span>/swapfile
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/swapfile
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>sudo<span class="w"> </span>mkswap<span class="w"> </span>/swapfile
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a>sudo<span class="w"> </span>swapon<span class="w"> </span>/swapfile<span class="w"> </span><span class="c1"># AutoDL是不允许这一步的，内存炸了就老老实实有卡模式启动吧</span>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="c1"># 使Swap永久生效</span>
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">'/swapfile swap swap defaults 0 0'</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/fstab<span class="w"> </span>
<a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="c1"># 检查</span>
<a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a>free<span class="w"> </span>-h
<a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a>
<a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="c1"># 2. 限制shell最大内存使用</span>
<a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="nb">ulimit</span><span class="w"> </span>-v<span class="w"> </span><span class="m">4194304</span><span class="w">  </span><span class="c1"># 限制为 4GB（单位KB）</span>
<a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a>
<a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="c1"># 3. 降低SSH优先级，避免OOM前被杀掉</span>
<a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="nb">echo</span><span class="w"> </span>-1000<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/proc/<span class="k">$(</span>pidof<span class="w"> </span>sshd<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">'{print $1}'</span><span class="k">)</span>/oom_score_adj<span class="w"> </span><span class="c1"># oom_score_adj: -1000 ~ +1000；设置$1是因为ssh可能有多个进程，可通过pidof sshd查看</span>
<a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a>
<a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="c1"># 这个命令不是一直生效的，可创建系统服务：</span>
<a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="c1"># vim /etc/systemd/system/sshd-oomprotect.service</span>
<a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="c1"># [Unit]</span>
<a href="#__codelineno-14-20" id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="c1"># Description=Set OOM score for sshd</span>
<a href="#__codelineno-14-21" id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="c1"># After=sshd.service</span>
<a href="#__codelineno-14-22" id="__codelineno-14-22" name="__codelineno-14-22"></a>
<a href="#__codelineno-14-23" id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="c1"># [Service]</span>
<a href="#__codelineno-14-24" id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="c1"># Type=oneshot</span>
<a href="#__codelineno-14-25" id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="c1"># ExecStart=/bin/bash -c 'echo -1000 &gt; /proc/$(pidof sshd | awk "{print \$1}")/oom_score_adj'</span>
<a href="#__codelineno-14-26" id="__codelineno-14-26" name="__codelineno-14-26"></a>
<a href="#__codelineno-14-27" id="__codelineno-14-27" name="__codelineno-14-27"></a><span class="c1"># [Install]</span>
<a href="#__codelineno-14-28" id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="c1"># WantedBy=multi-user.target</span>
<a href="#__codelineno-14-29" id="__codelineno-14-29" name="__codelineno-14-29"></a>
<a href="#__codelineno-14-30" id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="c1"># 使生效</span>
<a href="#__codelineno-14-31" id="__codelineno-14-31" name="__codelineno-14-31"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reexec
<a href="#__codelineno-14-32" id="__codelineno-14-32" name="__codelineno-14-32"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
<a href="#__codelineno-14-33" id="__codelineno-14-33" name="__codelineno-14-33"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>sshd-oomprotect
<a href="#__codelineno-14-34" id="__codelineno-14-34" name="__codelineno-14-34"></a>
<a href="#__codelineno-14-35" id="__codelineno-14-35" name="__codelineno-14-35"></a><span class="c1"># 4. 安装htop(进程查看，替代top)</span>
<a href="#__codelineno-14-36" id="__codelineno-14-36" name="__codelineno-14-36"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>htop<span class="w"> </span>-y
</code></pre></div>
<h4 id="_5">开源工具<a class="headerlink" href="#_5" title="Permanent link">¶</a></h4>
<p>比如<a href="https://github.com/rfjakob/earlyoom">EarlyOOM</a>。效果还没试，只看到star比较高就用了。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="c1"># Ubuntu</span>
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>earlyoom
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="c1"># 启动</span>
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a>./earlyoom
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>--now<span class="w"> </span>earlyoom
</code></pre></div>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="c1"># Amazon Linux(手动编译)</span>
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/rfjakob/earlyoom.git
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="nb">cd</span><span class="w"> </span>earlyoom
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="c1"># 安装gcc</span>
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>sudo<span class="w"> </span>yum<span class="w"> </span>groupinstall<span class="w"> </span>-y<span class="w"> </span><span class="s2">"Development Tools"</span>
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a>make
<a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="c1"># 将earlyoom注册为系统服务</span>
<a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a>sudo<span class="w"> </span>make<span class="w"> </span>install<span class="w">              </span><span class="c1"># systemd</span>
<a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a>sudo<span class="w"> </span>make<span class="w"> </span>install-initscript<span class="w">   </span><span class="c1"># non-systemd</span>
<a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a>
<a href="#__codelineno-16-11" id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="c1"># 设置开机自启</span>
<a href="#__codelineno-16-12" id="__codelineno-16-12" name="__codelineno-16-12"></a>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>earlyoom.service
<a href="#__codelineno-16-13" id="__codelineno-16-13" name="__codelineno-16-13"></a>systemctl<span class="w"> </span>restart<span class="w"> </span>earlyoom.service
<a href="#__codelineno-16-14" id="__codelineno-16-14" name="__codelineno-16-14"></a>systemctl<span class="w"> </span>status<span class="w"> </span>earlyoom.service<span class="w"> </span>
</code></pre></div>
<h2 id="check">Check<a class="headerlink" href="#check" title="Permanent link">¶</a></h2>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1"># 系统信息</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>uname<span class="w"> </span>-a<span class="w">                    </span><span class="c1"># 内核版本</span>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a>cat<span class="w"> </span>/etc/os-release<span class="w">         </span><span class="c1"># 操作系统版本</span>
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a>uptime<span class="w">                      </span><span class="c1"># 运行时间和负载</span>
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a>
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="c1"># 硬件资源</span>
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a>free<span class="w"> </span>-h<span class="w">                     </span><span class="c1"># 内存使用情况</span>
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a>df<span class="w"> </span>-h<span class="w">                       </span><span class="c1"># 磁盘使用情况</span>
<a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a>lscpu<span class="w">                       </span><span class="c1"># CPU 信息</span>
<a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a>vmstat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">                  </span><span class="c1"># 系统资源状态</span>
<a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a>
<a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="c1"># 网络配置</span>
<a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a>ip<span class="w"> </span>addr<span class="w">                     </span><span class="c1"># 网络接口</span>
<a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a>netstat<span class="w"> </span>-tulpn<span class="w">              </span><span class="c1"># 开放端口</span>
<a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a>curl<span class="w"> </span>-I<span class="w"> </span>localhost<span class="w">           </span><span class="c1"># 检查 web 服务</span>
<a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a>ss<span class="w"> </span>-tuln<span class="w">                    </span><span class="c1"># 查看监听端口</span>
<a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a>
<a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="c1"># 服务状态</span>
<a href="#__codelineno-17-19" id="__codelineno-17-19" name="__codelineno-17-19"></a>systemctl<span class="w"> </span>list-units<span class="w"> </span>--type<span class="o">=</span>service<span class="w"> </span>--state<span class="o">=</span>running<span class="w">  </span><span class="c1"># 运行中的服务</span>
<a href="#__codelineno-17-20" id="__codelineno-17-20" name="__codelineno-17-20"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>nginx<span class="w"> </span><span class="c1"># 检查 Nginx 状态（如果有）</span>
<a href="#__codelineno-17-21" id="__codelineno-17-21" name="__codelineno-17-21"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>apache2<span class="w"> </span><span class="c1"># 检查 Apache 状态（如果有）</span>
<a href="#__codelineno-17-22" id="__codelineno-17-22" name="__codelineno-17-22"></a>
<a href="#__codelineno-17-23" id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="c1"># 安全检查</span>
<a href="#__codelineno-17-24" id="__codelineno-17-24" name="__codelineno-17-24"></a>sudo<span class="w"> </span>fail2ban-client<span class="w"> </span>status<span class="w"> </span><span class="c1"># 防护状态(如已安装)</span>
<a href="#__codelineno-17-25" id="__codelineno-17-25" name="__codelineno-17-25"></a>cat<span class="w"> </span>/var/log/auth.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Failed<span class="w"> </span><span class="c1"># 登录失败记录</span>
<a href="#__codelineno-17-26" id="__codelineno-17-26" name="__codelineno-17-26"></a>ls<span class="w"> </span>-la<span class="w"> </span>~/.ssh/authorized_keys<span class="w"> </span><span class="c1"># 检查 SSH 密钥</span>
<a href="#__codelineno-17-27" id="__codelineno-17-27" name="__codelineno-17-27"></a>
<a href="#__codelineno-17-28" id="__codelineno-17-28" name="__codelineno-17-28"></a><span class="c1"># 日志检查</span>
<a href="#__codelineno-17-29" id="__codelineno-17-29" name="__codelineno-17-29"></a>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">50</span><span class="w"> </span>/var/log/syslog<span class="w">  </span><span class="c1"># 系统日志</span>
<a href="#__codelineno-17-30" id="__codelineno-17-30" name="__codelineno-17-30"></a>journalctl<span class="w"> </span>-xe<span class="w">             </span><span class="c1"># 系统日志(systemd)</span>
<a href="#__codelineno-17-31" id="__codelineno-17-31" name="__codelineno-17-31"></a>
<a href="#__codelineno-17-32" id="__codelineno-17-32" name="__codelineno-17-32"></a><span class="c1"># Web 服务器配置检查</span>
<a href="#__codelineno-17-33" id="__codelineno-17-33" name="__codelineno-17-33"></a>nginx<span class="w"> </span>-t<span class="w">                   </span><span class="c1"># Nginx 配置检查</span>
<a href="#__codelineno-17-34" id="__codelineno-17-34" name="__codelineno-17-34"></a>apache2ctl<span class="w"> </span>-t<span class="w">              </span><span class="c1"># Apache 配置检查</span>
<a href="#__codelineno-17-35" id="__codelineno-17-35" name="__codelineno-17-35"></a>
<a href="#__codelineno-17-36" id="__codelineno-17-36" name="__codelineno-17-36"></a><span class="c1"># 性能监控</span>
<a href="#__codelineno-17-37" id="__codelineno-17-37" name="__codelineno-17-37"></a>top<span class="w"> </span>-b<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w">                </span><span class="c1"># 进程资源使用</span>
<a href="#__codelineno-17-38" id="__codelineno-17-38" name="__codelineno-17-38"></a>iostat<span class="w"> </span>-x<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">              </span><span class="c1"># 磁盘 I/O 性能</span>
<a href="#__codelineno-17-39" id="__codelineno-17-39" name="__codelineno-17-39"></a>
<a href="#__codelineno-17-40" id="__codelineno-17-40" name="__codelineno-17-40"></a><span class="c1"># 进程检查</span>
<a href="#__codelineno-17-41" id="__codelineno-17-41" name="__codelineno-17-41"></a>
<a href="#__codelineno-17-42" id="__codelineno-17-42" name="__codelineno-17-42"></a><span class="c1"># 检查占用端口的进程</span>
<a href="#__codelineno-17-43" id="__codelineno-17-43" name="__codelineno-17-43"></a>sudo<span class="w"> </span>lsof<span class="w"> </span>-i<span class="w"> </span>:8080
<a href="#__codelineno-17-44" id="__codelineno-17-44" name="__codelineno-17-44"></a>sudo<span class="w"> </span>netstat<span class="w"> </span>-tulnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="c1"># tulnp: tcp udp listen port number</span>
<a href="#__codelineno-17-45" id="__codelineno-17-45" name="__codelineno-17-45"></a><span class="c1"># 干掉进程</span>
<a href="#__codelineno-17-46" id="__codelineno-17-46" name="__codelineno-17-46"></a>sudo<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-9<span class="w"> </span><span class="k">$(</span>lsof<span class="w"> </span>-t<span class="w"> </span>-i:8080<span class="k">)</span><span class="w"> </span><span class="c1"># -t: 只显示PID</span>
</code></pre></div>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  回到页面顶部
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2025 Chesszyh
    </div>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/Chesszyh" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.path", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "search.highlight", "search.suggest", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
<script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
</body>
</html>