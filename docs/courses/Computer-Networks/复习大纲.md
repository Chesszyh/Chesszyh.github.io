# 复习提纲

> Learning with Copilot: 我正在进行计算机网络复习，“复习大纲.md”是老师给的考点，我已经填充了部分解答和分析，请你仔细阅读，根据你掌握的知识，将剩余空白部分进行详细补充，帮助我更好的复习。注意不要改动我的二级标题和三级标题。

## 填空选择的复习范围

### 1. 三网及三网合一的概念

1. 电信网络：强调实时性（低延迟），可靠性要求一般（人耳对短暂的噪音不敏感），带宽要求较低（语音频段窄）。采用电路交换技术。
2. 有线电视网络：强调高带宽（视频数据量大）和广播能力，实时性要求高（直播），但传统上是单向传输。
3. 计算机网络：强调高带宽和数据传输的可靠性，对实时性和带宽的要求随应用而变（突发性强）。采用分组交换技术。

三网合一：业务层的统一，计算机网络正在成为三网合一的基础平台。

### 2. 计算机网络的定义、分类和功能

- 定义：计算机网络是由若干计算机及相关设备通过通信介质互联而成的系统，以实现资源共享和信息交换。
- 架构
    - 客户-服务器(C/S)
    - 浏览器-服务器(B/S)
- 分类体系
    - 按传输技术
        - 广播式网络：网络中的所有机器共享一条公共通信信道。分为单播、多播和广播。
            - 局域网
        - 点对点网络：网络由许多成对的链路组成，数据传输通常需要经过多个中间节点（路由器）。
            - 广域网
    - 按地理范围
        - 个域网（PAN）
        - 局域网（LAN）
        - 城域网（MAN）
        - 广域网（WAN）
            - 资源子网：所有的主机和终端
            - 通信子网：路由器和链路
        - 互联网（Internet）
- 功能
    - **数据通信**：这是计算机网络最基本的功能，包括连接控制、传输控制等。
    - **资源共享**：包括硬件资源（打印机、存储设备）、软件资源（应用软件）和数据资源（数据库）的共享。
    - **分布式处理**：将任务分散到多台计算机上处理，提高效率和可靠性。
    - **提高可靠性**：通过冗余和备份，单点故障不影响整体运行。
    - **负载均衡**：将工作负载均匀分配给网络中的计算机。

### 3. 协议分层的思想、分层后的数据传输（封装和解封）

- 分层设计的核心原则：独立性、灵活性、结构化
- 核心概念
    - 协议：两个对等实体（不同机器上的同一层）之间的通信规则
    - 接口：同一系统中，相邻两层之间的边界
    - 服务：下层为紧邻的上层提供的功能调用
- 数据传输
    - 封装：
        - SDU (Service Data Unit)：服务数据单元
        - PDU (Protocol Data Unit)：协议数据单元
        - PCI (Protocol Control Information)：协议控制信息
        - PDU = PCI + SDU。第N层把第N+1层的PDU作为自己的SDU，加上自己的头部，形成第N层的PDU。
    - 解封：
        - 接收端按相反顺序进行解封装，逐层处理PDU，提取SDU并传递给上层。

### 4. OSI RM：用途、7 层、每层主要功能、通信子网和资源子网的范围

- OSI参考模型：**物理层、数据链路层、网络层、传输层、会话层、表示层、应用层**
    - 物理层（不包含具体物理介质）
    - 数据链路层：点对点通信
    - 网络层：通信子网运行控制    
        - 支持**无连接+面向连接**两种服务
        - 流量控制、差错控制、拥塞控制、路由选择
    - 传输层：端到端通信
        - 仅有**面向连接**服务
        - 复用：多个应用层进程共享传输层连接
        - 分用：将传输层数据交付给正确的应用层进程
    - 会话层
    - 表示层
    - 应用层
- 通信子网范围：物理层、数据链路层、网络层
- 资源子网范围：传输层、会话层、表示层、应用层

### 5. TCP/IP RM：用途、4 层、每层主要功能、通信子网和资源子网的范围

- 层级划分
    - 网络接口层（数据链路层+物理层）：从主机或节点接受IP分组，并发送到指定物理网络
    - 网际层（网络层）：主机-主机通信，Ipv4/Ipv6
    - 运输层（传输层）：应用-应用，进程-进程通信
    - 应用层（OSI的应用层、表示层、会话层）
        - Telnet、FTP、SMTP、DNS、HTTP等
        - 支持**无连接+面向连接**两种服务
        - TCP(Transmission Control Protocol)：传输控制协议
        - UDP(User Datagram Protocol)：用户数据报协议
- “沙漏模型”：
    - 宽底（网络接口层）：支持多种物理网络
    - 窄腰（网际层）：IP协议，统一不同网络
    - 宽顶（应用层）
- 通信子网范围：网络接口层、网际层
- 资源子网范围：运输层、应用层

IP协议是互联网的核心协议。

### 6. 常用的标准化组织及制定的与本课程有关的标准

- **IEEE 802**：专注于局域网物理层和链路层标准（如802.3 Ethernet, 802.11 Wi-Fi）
    - 数据链路层的拆分：
        - 逻辑链路控制子层（LLC）：逻辑链路建立、差错和流量控制
            - 位于MAC层之上，屏蔽不同MAC子层的差异，向网络层提供统一的接口
        - 媒体访问控制子层（MAC）：多路访问控制，解决地址寻址（MAC地址）和信道争用问题等
            - 位于物理层之上，是局域网技术的核心

- **IETF (互联网工程任务组)**：负责Internet标准的制定。其文档称为 **RFC (Request For Comments)**。  
    - **RFC流程**：Internet Draft (草案) -> Proposed Standard (建议标准) -> Internet Standard (互联网标准)。所有RFC文档免费开放，体现了互联网的开放精神。  
- **ITU-T**：制定电信网络标准。
- **ISO**：制定了OSI参考模型。

### 7. 路由器（Router）、以太网交换机（Switch）和集线器（Hub）的比较

| 特性 | 集线器 (Hub) | 交换机 (Switch) | 路由器 (Router) |
| :--- | :--- | :--- | :--- |
| **工作层次** | 物理层 | 数据链路层 (MAC层) | 网络层 |
| **工作原理** | 信号放大与广播（位级复制） | 存储转发 / 直通（帧级转发） | 路由选择与分组转发（包级转发） |
| **处理对象** | 比特流 (Bit) | 数据帧 (Frame) | 数据包/分组 (Packet) |
| **冲突域** | 所有端口在一个冲突域 | 每个端口独立的冲突域 | 每个端口独立的冲突域 |
| **广播域** | 所有端口在一个广播域 | 所有端口在一个广播域 (VLAN除外) | 每个端口独立的广播域 |
| **寻址方式** | 无寻址 | MAC地址 | IP地址 |
| **性能** | 共享带宽，效率低 | 独享带宽，全双工 | 转发速率受处理能力限制 |
| **主要功能** | 扩展网络覆盖范围 | 组建局域网，分段冲突域 | 互联不同网络，选择最佳路径 |

### 8. 传输介质：双绞线、光纤（单模光纤和多模光纤的比较）、通信卫星

- 有导向传输介质
    - 双绞线：两根绝缘导线互相缠绕，减少电磁干扰
    - 同轴电缆：内导体和屏蔽层共轴，比双绞线抗干扰能力强
    - 光纤
        - 单模光纤：传输距离远，带宽高，成本高，安装要求高
        - 多模光纤：传输距离近，带宽低，成本低，安装要求低
- 无导向传输介质
    - 无线电波
    - 微波
    - 通信卫星

### 9. PCM：会计算数据传输速率，如：T1 载波的速率 1.544Mbps

- PCM（脉冲编码调制）：
    - 采样：按奈奎斯特定理，采样频率至少为信号最高频率的两倍，才能无损还原模拟信号
    - 量化：将采样得到的连续模拟值映射为离散的数字级
    - 编码：将量化后的数字级转换为二进制码
- PCM速率：$R = f_s \times \text{bit\_depth}$
    - $f_s$：采样频率（Hz）
    - bit_depth：量化位数（每个样本的比特数）
- T1载波(北美/日本标准)
    - 24个语音信道，每个信道8bits(64kbps)，每帧24x8+1(帧同步位)=193bits
    - 总速率：193bits/frame x 8000frames/s = 1.544Mbps
    - 信令：比特借用 (Robbed Bit Signaling)，在特定帧（如第6、12帧）中，每个信道的最低有效位（LSB）被挪用传输信令。因此，数据传输速率降低为56kbps。
- E1载波(欧洲/中国标准)
    - 32个语音信道，每个信道8bits(64kbps)，每帧32x8=256bits
    - 总速率：256bits/frame x 8000frames/s = 2.048Mbps
    - 数据与信令完全分离（共路信令），每个话路都能提供完整的 64 kbps 透明传输
- SONET/SDH 光传输标准
    - 总速率：51.84Mbps 的整数倍

### 10. 常用调制技术

- 数据编码技术：如何用信号表示数据
- 模拟信号调制
    - 基础调制技术
        - 幅移键控（ASK）：改变载波幅度表示0/1，抗噪声能力弱
        - 频移键控（FSK）：改变载波频率
        - 相移键控（PSK）：改变载波相位
    - 正交幅度调制（QAM）：同时改变载波的幅度和相位，传输速率高
        - 现代高速通信（如Wi-Fi, 4G/5G）的核心技术
- 数字信号编码
    - 曼彻斯特编码：每比特中间有跳变，易于时钟同步，抗干扰能力强，但带宽利用率低
    - 差分曼彻斯特编码：类似曼彻斯特编码，但跳变位置不同
    - 非归零编码（NRZ）：简单，但易受直流分量影响，难以时钟同步
    - 4B/5B 编码：将4位数据映射为5位码字，增加冗余以保证足够的跳变
- 模拟数据的数字化 (PCM)：见上一条
- 扩频技术：
    - 直接序列扩频（DSSS）：将数据与高速伪随机码进行异或运算
    - 跳频扩频（FHSS）：在多个频率间快速随机切换传输

### 11. 格雷码（Gray code）

- 特点：相邻的两个数值，其二进制表示只有一位不同。可以减少传输过程中的误码率。
- **二进制转格雷码**：
    - 保留最高位：$G_n = B_n$
    - 其余位：$G_i = B_{i+1} \oplus B_i$ （每一位与它左边的一位异或）
- **格雷码转二进制**：
    - 保留最高位：$B_n = G_n$
    - 其余位：$B_i = B_{i+1} \oplus G_i$ （每一位与它左边计算出来的二进制位异或）

### 12. 多路复用技术：FDM/TDM/WDM/CDMA 的原理和比较，其中 CDMA 要求会计算接收方收到的数据，和为每个站点分配码片序列

- 多路复用：将多个低速或低带宽的信号组合成一个高速或宽带的复合信号
- 频分多路复用（FDM）：将频带划分为多个互不重叠的子频带
    - 保护频带：防止相邻信道干扰
    - 缺点：信道利用率低
    - 正交频分复用（OFDM）：提高频谱利用率
- 时分多路复用（TDM）：将时间划分为多个时隙
    - 同步TDM：固定时隙分配
    - 异步TDM（统计TDM）：动态分配时隙，时间片（或分组）必须包含地址信息（头部），提高信道利用率
- 波分多路复用（WDM）：光纤通信中的FDM
    - 密集波分多路复用（DWDM）：信道间隔更小，支持更多信道
- **码分多路复用**（CDMA）：允许所有站点在同一时间、同一频段上进行传输，通过不同的码片序列进行区分
    - 每个用户分配唯一的码片序列，所有站点分配的码片序列必须**相互正交**
    - 1-原码，0-反码
    - **信号还原**：将总信号与目标站点的码片序列进行内积运算

### 13. 自组织网络（Ad hoc network）和传感器网络（sensor network）在移动性和电耗控制方面的比较

| 比较维度 | Ad hoc 网络 (MANET) | 无线传感器网络 (WSN) |
| :--- | :--- | :--- |
| **移动性** | **高**：节点通常是移动设备（笔记本、手机），拓扑结构动态变化快。主要服务于人。 | **低**：节点通常固定部署，或移动缓慢。主要服务于环境监测。 |
| **电耗控制** | 关注，但节点通常可充电或更换电池。主要关注QoS和带宽利用率。 | **极度敏感**：节点通常不可充电/更换，电池寿命决定网络寿命。主要关注节能（休眠机制）。 |
| **网络规模** | 相对较小，几十到几百个节点。 | 很大，成千上万个微小节点。 |
| **数据模式** | 除了路由信令外，多为点对点数据传输。 | 主要是**多对一**（汇聚到Sink节点），数据冗余度高。 |

### 14. CRC 码，会生成和验证

- **生成多项式** $G(x)$：最高位和最低位必须为1。若$G(x)$阶数为$r$，则FCS（帧校验序列）为$r$位。
- **生成步骤**（发送端）：
    1. 设待发送数据为 $M$。
    2. 在 $M$ 后面添加 $r$ 个 0，得到 $M'$。
    3. 用模2除法（异或运算，不借位），$M'$ 除以 $G(x)$。
    4. 得到的余数即为 **FCS**。
    5. 发送的帧为 $M + FCS$（将余数替换掉添加的 $r$ 个 0）。
- **验证步骤**（接收端）：
    1. 接收到的帧 除以 $G(x)$。
    2. 若余数为 0，则认为无差错；否则丢弃。

### 15. 海明码：会计算冗余位的位数

- 海明距离：两个有效码字之间不同位的个数
- 要纠正 $d$ 个错误，编码系统的最小海明距离必须达到 $2d+1$
- 冗余位数 $r$ 与数据位数 $k$ 的关系：$2^r \geq k + r + 1$
- 计算：
    1. 确定校验位：校验位位于 $2^n$ 的位置 ($1, 2, 4, 8, \dots$)。
    2. 计算校验值：每个校验位负责校验某些特定数据位（其位置二进制表示中该位为1的位）。采用偶校验。
    3. 纠错：接收方重新计算所有校验位。若全为0则无错；否则，计算出的二进制值即为出错位的位置。

### 16. 数据链路层数据成帧（解决帧同步）的四种方法，重点是面向比特的首位定界符法，掌握 0bit 插入/删除

数据成帧：解决帧定界、帧同步、透明传输问题。

- 字节计数法：在帧的头部设置字节计数字段（包括头部自身）
    - 一旦计数字段出错，后续会连续出错
- 使用字符填充的首尾定界符法
    - 使用特殊的起始和结束字符作为帧定界符，并将数据段中的相同字符进行转义处理
    - 如PPP协议中的`FLAG`
    - 依赖于特定的字符编码集，传输二进制文件时不佳
- **使用比特填充的首尾定界符法**
    - 使用特殊的比特序列作为帧定界符
        - 如`01111110`
        - 数据段进行比特填充：连续5个1后插入一个0，避免与定界符混淆
    - 容易通过硬件实现
- 物理层编码违例法
    - 完全依赖于底层物理层所采用的特定编码技术，降低了数据链路层的独立性和协议的可移植性
    - 主要用于局域网

### 17. 自动重发请求（ARQ）协议：确认+定时器+帧编号

- 确认：接收方收到正确帧后，发送确认帧（ACK）给发送方
- 定时器：发送方在发送帧后启动定时器，若在超时时间内未收到确认，则重传该帧
- 帧编号：防止重复帧
    - 停止-等待协议：1位帧编号（0或1）
    - 滑动窗口协议：n位帧编号，窗口大小受限于帧编号范围
    
### 18. 滑动窗口协议与停-等协议、后退 N 帧协议、选择重发协议的关系（从窗口大小进行比较，记住发送窗口的最大值）

假设帧序号位数为 $n$ 比特，序号空间大小为 $2^n$。

| 协议 | 发送窗口 $W_T$ | 接收窗口 $W_R$ | 特点 |
| :--- | :--- | :--- | :--- |
| **停止-等待 (Stop-and-Wait)** | $W_T = 1$ | $W_R = 1$ | 发送一帧，等待确认。效率低。 |
| **后退 N 帧 (Go-Back-N, GBN)** | $1 < W_T \le 2^n - 1$ | $W_R = 1$ | 累积确认。接收方只接受按序到达的帧。若出错，发送方重传所有已发送但未确认的帧。 |
| **选择重发 (Selective Repeat, SR)** | $W_T \le 2^{n-1}$ | $W_R \le 2^{n-1}$ | 独立确认。接收方缓存乱序帧。若出错，只重传出错的那一帧。通常取 $W_T = W_R = 2^{n-1}$。 |

**重要限制**：
- GBN：$W_T + W_R \le 2^n$，因 $W_R=1$，故 $W_T \le 2^n - 1$。
- SR：$W_T + W_R \le 2^n$，为避免接收窗口前移后与旧窗口序号重叠，通常 $W_T$ 不超过序号空间的一半。

### 19. HDLC 协议

- HDLC（High-level Data Link Control）：ISO制定的**面向比特的数据链路层协议**。常用于广域网（WAN）中的点对点链路，也为PPP协议提供基础。

- 站类型
    - 主站：链路控制者，发送命令帧
    - 从站：受控者，只能发送响应帧
    - 复合站：既能作为主站也能作为从站
- 传输模式
    - 正常响应模式（NRM）：主站轮询从站
    - 异步响应模式（ARM）：从站可以主动发起传输
    - 异步平衡模式（ABM）：最常用的模式（如两台路由器互联），两个复合站地位平等，任何一方都可以随时发起数据传输，无需轮询

- 帧结构
    - 标志字段（Flag）：`0x7E`，帧定界符
        - 比特填充：连续5个1后插入一个0，避免与定界符`01111110`混淆
    - 地址字段（Address）：标识目的站点
    - 控制字段（Control）：帧类型和序号信息
        - 注：`N(S)`：发送序号，`N(R)`：接收序号/期望收到的下一个帧序号，`P/F`：命令（P，轮询）/响应（F，结束）位
        - 信息帧（I帧）：`0 N(S) P/F N(R)`
        - 监控帧（S帧）：`10 SS P/F N(R)`
            - 类型编码（SS）：
                - `00` RR（接收就绪）：确认 N(R)-1 及之前所有帧，准备接收 N(R)
                - `10` RNR（接收非就绪）：同 RR，但表示接收方暂时无法接收数据
                - `01` REJ（拒绝重传）：拒绝，即Go-Back-N的NAK。请求发送方重传 N(R) 及之后的所有帧
                - `11` SREJ（选择重传）：选择重传，即Selective Repeat的NAK。请求发送方只重传 N(R) 帧
        - 无编号帧（U帧）：`11 NM P/F MMM`
            - 链路管理功能，如建立/断开链路、测试链路等
    - 信息字段（Information）：承载数据
    - 帧校验序列（FCS）：差错检测

| 标志 (Flag) | 地址 (Address) | 控制 (Control) | 信息 (Information) | FCS | 标志 (Flag) |
|:-----------:|:--------------:|:--------------:|:------------------:|:---:|:-----------:|
| 8 bits      | 8 bits         | 8/16 bits      | 可变长度           | 16/32 bits | 8 bits      |

### 20. PPP 协议

- PPP协议（Point-to-Point Protocol）：数据链路层协议，互联网接入的标准，用于在点对点链路上封装IP数据报。支持多种网络层协议（如 IP、IPX 和 AppleTalk），常用于拨号连接和广域网（WAN）环境。

- 帧结构
    - `FLAG`：`0x7E`，帧定界符
    - `Address`：`0xFF`，广播地址(无须寻址)
    - `Control`：`0x03`，无编号信息帧
    - `Protocol`：标识净荷数据的类型
        - `0x0021`：IP
        - `0xC021`：LCP(Link Control Protocol)：链路控制协议，用于建立、配置和测试数据链路连接
        - `0x8021`：IPCP(Internet Protocol Control Protocol)：用于配置和管理IP参数
        - `0xC023`：PAP(Password Authentication Protocol)：密码认证协议
            - 两次握手认证，简单明文传输，客户端发起
        - `0xC223`：CHAP(Challenge Handshake Authentication Protocol)：质询握手认证协议
            - 三次握手认证（Server发送随机数挑战，Client返回Hash运算加密后响应，Server验证），更安全，Server发起
    - `Information`：承载数据，可变长度
    - `FCS`：差错检测
    - `FLAG`：`0x7E`

| Flag  | Address | Control | Protocol   | Information | FCS      | Flag  |
|-------|---------|---------|------------|-------------|----------|-------|
| 0x7E  | 0xFF    | 0x03    | 1或2字节   | 变长        | 2或4字节 | 0x7E  |

- 生命周期
    - 链路建立阶段：使用LCP协商链路参数
    - 认证阶段（可选）：使用PAP或CHAP进行身份验证
    - 网络层协议配置阶段：使用IPCP配置IP参数
    - 数据传输阶段：传输封装的网络层数据
    - 链路终止阶段：通过LCP终止链路连接

### 21. LAN RM 的基本概念

LAN RM（Local Area Network Reference Model，本地局域网参考模型）是一个用于描述**局域网体系结构**的参考框架。它类似于 OSI 模型，但专注于局域网的特性和需求。

- 层次结构
    - 物理层
    - 数据链路层
        - 媒体访问控制 (MAC) 子层：下层，与传输介质有关，负责介质访问控制、帧的寻址和定界、差错检测等
        - 逻辑链路控制 (LLC) 子层：上层，与传输介质无关，向网络层提供统一的服务接口
    - 网络层及以上：LAN RM 通常不直接定义这些层，而是依赖于其他协议（如 TCP/IP）来实现

### 22. CSMA/CD：思想、本质、会最短帧长的计算

“边说边听” (Listen While Talk)

#### 工作原理

1. **发送前侦听：** 使用 1-坚持算法侦听信道。  
2. **边发边听：** 在发送数据的同时，检测信道上的电压变化。如果信号电压超过阈值（两波叠加），说明发生了冲突。  
3. **冲突停止：** 一旦检测到冲突，**立即停止发送数据**。  
4. **强化干扰（Jamming）：** 发送人为干扰信号（Jam Signal，通常 32-48 比特），确保网络上所有站点（包括远端站点）都能检测到冲突发生。  
5. **指数退避：** 执行二进制指数退避算法，等待随机时间后重试。

#### 争用期与最小帧长 (2τ)

CSMA/CD 有一个物理限制：**发送站必须在发送完一帧之前检测到冲突**。如果帧太短，发送站可能在冲突信号传回之前就已经认为发送成功了。

设 $\tau$ 为单程传播时延。最坏情况是：

- $t=0$：A 站发送。  
- $t=\tau - \epsilon$：信号即将到达 B 站，B 站尚未检测到，于是 B 站也开始发送。 
- $t=\tau$：冲突在 B 处发生。  
- $t=2\tau - \epsilon$：冲突信号传回 A 站。

因此，A 站必须至少发送 **$2\tau$** 时间的数据，才能保证检测到所有的冲突。$2\tau$ 被称为**争用期**或**孔径时间**。

最小帧长 = 数据传输率 × $2\tau$。

#### 二进制指数退避算法

1. 确定基本退避时间为 $2\tau$。  
2. 定义重传次数 $k$。$k = \min(\text{重传次数}, 10)$。  
3. 从整数集合 $[0, 1, \dots, 2^k - 1]$ 中随机取一个数 $r$。  
4. 等待时间 $= r \times 2\tau$。  
5. 若重传达 16 次仍不成功，丢弃该帧并报错。

随着冲突次数增加，随机选择的范围指数级扩大（$2, 4, 8, \dots, 1024$）。这种机制能自适应地分散高负载下的流量，具有极强的鲁棒性。

#### 信道利用率与问题

信道利用率：$$S = \frac{1}{1 + 2e \cdot a}$$

其中，$a = \frac{\tau}{T_{frame}}$，$\tau$ 为单程传播时延，$T_{frame}$ 为帧传输时延。

- CSMA/CD适合有线局域网，不适合长距离或超高带宽的网络环境，比如WLAN(无线局域网)
    - 无法检测冲突： 无线网卡通常是半双工的，发送时信号太强，无法检测到远端的微弱冲突信号
    - 暴露站问题：某些站点接收到其他站点的发送信号，导致自身因可能的冲突（实际不冲突）“不敢”发送信号
    - 隐蔽站问题：某些站点无法听到其他站点的信号，可能在共同的接受节点发生冲突

### 23. 3 类多点访问协议分别有哪些？

- 随机访问协议
    - ALOHA
        - 纯ALOHA：任意时刻发送，冲突后随机重传，效率低（18%）。
        - 时隙ALOHA：时间划分为离散时隙，只在时隙开始时发送，效率提高到36%。
    - CSMA
        - 1-坚持式
        - 非坚持式
        - p-坚持式
    - CSMA/CD
    - CSMA/CA
- 受控访问协议
    - 位图协议
    - 二进制倒计数协议
    - 令牌传递协议
- 信道划分协议
    - 频分多路访问（FDMA）
    - 时分多路访问（TDMA）
    - 码分多路访问（CDMA）

### 24. 以太网产品的分代

- **标准以太网 (10 Mbps)**：10Base-5 (粗同轴), 10Base-2 (细同轴), 10Base-T (双绞线), 10Base-F (光纤)。
- **快速以太网 (100 Mbps)**：IEEE 802.3u。100Base-TX, 100Base-FX。保留了CSMA/CD，帧格式不变，缩短了位时间。
- **千兆以太网 (1 Gbps)**：IEEE 802.3z/ab。支持全双工（无冲突）和半双工（保留CSMA/CD，采用载波延伸和帧突发）。
- **10G 以太网 (10 Gbps)**：IEEE 802.3ae。只支持全双工，**不再使用 CSMA/CD**。

### 25. MAC 地址：格式和应用

- 48位全球唯一地址，以十六进制表示，分为6组，每组2位
    - 前24位（OUI，组织唯一标识符）：由IEEE分配给设备制造商
    - 后24位（扩展标识符）：由制造商自行分配，确保每个设备的唯一性
    - I/G位（第1字节最低位）：标识单播（0）或组播/广播（1）
    - U/L位（第1字节次低位）：标识全球唯一地址（0）或本地管理地址（1）
- 应用
    - 局域网中用于唯一标识网络接口
    - 以太网帧头中的源和目的MAC地址字段
    - 用于交换机的地址学习和转发决策

### 26. 以太网交换机的交换方式（重点掌握切入法，也称直通交换方式）、工作过程（同网桥）、总带宽的计算

- **交换方式**：
    - **直通交换 (Cut-through)**：只接收到帧的目的MAC地址（前6字节）就开始转发。**延迟最小**，但不检查差错，可能转发错误帧。
    - **存储转发 (Store-and-Forward)**：完整接收整个帧，进行CRC校验，无误后再转发。可靠性高，支持不同速率端口转换，但延迟大。
    - **无碎片 (Fragment-free)**：接收前64个字节（冲突窗口）后转发。过滤掉因冲突产生的碎片。
- **工作过程**：自学习（源MAC, 端口），转发（查表，主要单播），广播（未知目的MAC或广播帧），老化（定时删除旧表项）。
- **总带宽**：对于全双工交换机，总带宽 = 端口数 $\times$ 端口速率 $\times$ 2。
    - x2 是因为全双工模式下，发送和接收可以同时进行。

### 27. IEEE802.11 MAC帧中地址的使用

802.11帧头包含4个地址字段 (Addr1, Addr2, Addr3, Addr4)，其含义也就是源(SA)、目的(DA)、发送端(TA)、接收端(RA) 根据 "To DS" 和 "From DS" 标志位变化：

| To DS | From DS | 地址1 (接收端 RA) | 地址2 (发送端 TA) | 地址3 (目的地址/源地址/BSSID) | 地址4 (源地址/目的地址（仅WDS）) | 应用场景                                                                                 |
| :---- | :------ | :---------------- | :---------------- | :---- | :---- | :--------------------------------------------------------------------------------------- |
| 0     | 0       | DA (目的)         | SA (源)           | BSSID | N/A   | Ad-hoc网络或管理帧。直接通信。                                                           |
| 0     | 1       | DA (目的)         | BSSID (AP)        | SA (源) | N/A   | 下行： AP发给手机。TA是AP，但SA是发数据的服务器。                                        |
| 1     | 0       | BSSID (AP)        | SA (源)           | DA (目的) | N/A   | 上行： 手机发给AP。RA是AP，但DA是目标服务器。                                            |
| 1     | 1       | RA (接收AP)       | TA (发送AP)       | DA    | SA    | WDS (无线桥接)： 两个AP之间传输数据。需要同时保留原始源SA、最终目的DA、以及当前跳的收发AP地址。 |


*注：DS=分配系统 (Distribution System)，STA=工作站，AP=接入点，BSSID=AP的MAC地址。*

### 28. WLAN 组网模式有哪些？各自特点有哪些？

- **有基础设施模式 (Infrastructure Mode)**：
    - **基本服务集 (BSS)**：由一个AP和若干STA组成。所有通信通过AP转发。
    - **扩展服务集 (ESS)**：多个BSS通过分配系统 (DS) 连接而成。
    - 特点：覆盖范围广，管理集中，支持漫游。
- **无基础设施模式 (Ad hoc Mode / IBSS)**：
    - 没有AP，STA之间直接通信。
    - 特点：组网灵活，无需预设设施，抗毁性强，但多跳路由复杂。

### 29. VLAN 的基本概念和划分

- **概念**：虚拟局域网，将物理局域网在逻辑上划分为多个广播域。不同VLAN间通信需通过路由器（或三层交换机）。
- **优点**：限制广播风暴，提高安全性，灵活管理工组。
- **划分方式**：
    1.  **基于端口**：静态，最常用。
    2.  **基于MAC地址**：动态，用户移动端口不变VLAN。
    3.  **基于网络层协议/IP子网**。
- **802.1Q 帧格式**：在源地址后插入4字节Tag，包含 **12位 VLAN ID** (VID)，支持4096个VLAN。

### 30. RIP 协议和 OSPF 协议

| 协议 | RIP (Routing Information Protocol) | OSPF (Open Shortest Path First) |
| :--- | :--- | :--- |
| **类型** | 距离向量 (Distance Vector) | 链路状态 (Link State) |
| **算法** | Bellman-Ford | Dijkstra (SPF) |
| **度量值** | 跳数 (Hop Count)，最大15，16为不可达 | 带宽 (Cost = 100Mbps/Bandwidth) |
| **更新方式** | 周期性广播 (30s) 整个路由表 | 只有链路状态变化时泛洪 LSA |
| **层级** | 应用层 (UDP 520) | 网络层 (IP 协议号 89) |
| **收敛速度** | 慢 (坏消息传得慢/计数到无穷大) | 快 |
| **适用范围** | 小型网络 | 大型网络 (支持划分区域 Area) |

### 31. 广播路由算法（重点掌握后面两个）

- **N次单播**：效率低，浪费带宽。
- **洪泛 (Flooding)**：每个节点将收到的包转发到除入口外的所有接口。可靠但产生大量重复包（广播风暴）。
- **生成树 (Spanning Tree)**：利用最小生成树或汇集树，每个路由器只沿树的分支转发。无回路，最优。
- **逆向路径转发 (Reverse Path Forwarding, RPF)**：
    - 当路由器收到广播包时，检查该包是否是从**到达源节点的最佳路径**（即单播路由表中的下一跳）对应的接口到来的。
    - 如果是，则向除入口外的所有接口转发；否则丢弃。
    - 优点：利用现有的单播路由表，无需建立树，避免环路。

### 32. 组播路由中的核心基本树，会计算使用/不使用核心基本树网络所需保存的树的数目

- DVMRP：使用RPF算法进行洪泛，如果边缘路由器发现该分支下没有组成员，则发送**剪枝（Prune）**消息，向上游修剪生成树。这被称为“广播-剪枝”策略。

- 核心基本树（CBT/PIM-SM）：在成员稀疏的网络中，洪泛效率太低。CBT指定一个核心路由器（Core/Rendezvous Point）。所有数据发送给核心，核心再沿共享树分发给成员。这避免了为每个源构建一棵树的开销。
- **计算**：
    - 不使用核心基本树：每个组播源都需要一棵以自己为根的组播树。对于每个组播组，理论上需要保存 $S$ 棵树（$S$ 为源的数量）。如果有 $G$ 个组播组，总共需要保存 $S \times G$ 棵树。
    - 使用核心基本树：只需保存一棵共享树，所有源的数据都通过核心路由器转发。因此对于每个组播组，只需保存 1 棵树。

### 33. 移动主机的路由选择：三角路由，特别注意地址的使用

CN -> HA -> MN -> CN 三角通信。打破了“IP地址对应固定地理位置”的假设。

- 移动IP（Mobile IP）
    - 主要组件
        - 家乡代理（Home Agent, HA）：位于移动主机的家乡网络，负责维护移动主机的当前位置
        - 外地代理（Foreign Agent, FA）：位于移动主机当前所在的外地网络，协助移动主机接收数据
            - 转交地址（Care-of Address, CoA）：移动主机在外地网络的临时IP地址
    - 工作原理：CN -> HA -> MN -> CN 三角通信
        - 移动主机在家乡网络注册其CoA给HA
        - HA接收到通信对端(CN)发往移动主机的分组后，将其封装（tunneling）并转发到FA(即CoA)
        - FA接收到封装分组后，解封装并交付给移动主机
    - 问题：即使CN和MN在同一个房间（但连接不同网络），数据也要绕回HA（可能在地球另一端）
    - 优化：通过“路由优化”，HA可以告知CN移动主机的当前CoA，后续CN可直接向CoA发送隧道封装的数据，从而“打通”三角形的底边。

### 34. RSVP 协议

- **资源预留协议 (Resource Reservation Protocol)**：是一种用于IP网络的信令协议，主要用于为数据流预留网络资源，支持服务质量（QoS）管理。
    - 属于传输层和网络层之间的信令协议，独立于具体的传输协议（如TCP/UDP）
- **机制**：由接收方发起预留请求 (RESV)，沿着数据流的反向路径向发送方发送。
- **特点**：
    - 单向预留
    - 面向连接
    - **软状态 (Soft State)**：路由器中的预留状态需要定期刷新，否则会超时删除。

### 35. IPv4 地址，注意私有地址和特殊地址，特别是两个广播地址的使用

- **分类**：A类(0...), B类(10...), C类(110...), D类(组播 1110...), E类(保留 1111...)。
- **私有地址** (不可在公网路由)：
    - A类：`10.0.0.0/8`
    - B类：`172.16.0.0/12` (172.16.0.0 - 172.31.255.255)
    - C类：`192.168.0.0/16`
- **特殊地址**：
    - `127.x.x.x`：环回地址 (Loopback)，本机测试。
    - `0.0.0.0`：本网络上的本主机（如DHCP请求源地址）。
    - `255.255.255.255`：**受限广播地址**（本地广播），只在本局域网内传播，路由器不转发。
    - `网络号 | 全1主机号`：**直接广播地址**，发送到特定网络的所有主机（如192.168.1.255），路由器通常默认拦截以防攻击。
    - `224.0.0.0` - `239.255.255.255`：**组播地址**，用于一对多通信。

### 36. 层次路由的基本思想，会计算表项数的得失

- **思想**：将网络划分为多个区域 (Region/Area)，路由器只知道本区域内的详细路由，以及通往其他区域的宏观路径。
- **优点**：大幅减小路由表规模，节省路由器内存和CPU，隔离路由波动。
- **缺点**：可能导致路径非最优 (Sub-optimal routing)。
- **计算**：假设网络有 $N$ 个路由器。若不分层，表项数 $N$。若分层，$M$ 个区域，每区域 $N/M$ 个路由器。每个路由器只需维护区域内 $N/M$ 条 + 通往其他 $M-1$ 个区域的条目。总数 $\approx N/M + M$。

### 37. IP 数据报的分片和重组：特别注意片偏移字段的单位是 8B，故分片 IP 数据报的数据部分必须是 8 的倍数

- **原因**：MTU (最大传输单元) 限制。不同链路层协议 MTU 不同 (以太网 1500B)。
- **字段**：
    - 标识 (Identification)：同一数据报的所有分片具有相同ID。
    - 标志 (Flags)：DF (Don't Fragment), MF (More Fragments, 1=还有分片, 0=最后一片)。
    - **片偏移 (Fragment Offset)**：指出该分片在原数据报中的相对位置。**单位是 8 字节**。
- **重组**：只在**目的主机**进行，路由器只管分片不管重组。

### 38. ARP 协议的工作过程

- **ARP (Address Resolution Protocol)**：根据 IP 地址解析 MAC 地址。
- **过程**：
    1.  主机A先查本地 ARP 缓存。若命中，直接使用。
    2.  若未命中，A 发送 **ARP 请求** (广播帧，FF:FF:FF:FF:FF:FF)。包含 A 的 IP/MAC 和 目标 B 的 IP。
    3.  局域网内所有主机收到请求。
    4.  B 发现请求的是自己的 IP，发送 **ARP 响应** (单播帧) 给 A，包含 B 的 MAC。其他主机丢弃。
    5.  A 收到响应，更新 ARP 缓存，并发送数据。

### 39. 传输层中端口号的作用、分类和应用

- **作用**：进程寻址 (Multiplexing/Demultiplexing)。区分同一台主机上的不同网络应用进程。
- **分类 (16位，0-65535)**：
    - **熟知端口 (Well-known)**：0-1023。指派给标准服务。如 FTP(21), SSH(22), Telnet(23), SMTP(25), DNS(53), HTTP(80), HTTPS(443)。
    - **注册端口 (Registered)**：1024-49151。供特定应用注册使用。如 MySQL(3306), RDP(3389)。
    - **动态/私有端口**：49152-65535。客户端发起连接时临时使用。

### 40. TCP 协议的差错控制和流量控制

- **差错控制** (可靠传输)：
    - 校验和 (Checksum)：检测比特错误。
    - 确认 (ACK)：累积确认。
    - 重传 (Retransmission)：超时重传 (RTO) 或 3次冗余ACK触发快速重传。
    - 序号 (Sequence Number)：检测丢失、乱序、重复。
- **流量控制** (防止发送方压垮接收方)：
    - **滑动窗口**机制。
    - 接收方在 TCP 头部的 `Window` 字段通告自己的接收窗口大小 (rwnd)。
    - 发送方保证：未确认数据量 $\le$ rwnd。
    - 坚持定时器 (Persist Timer)：解决零窗口死锁。

### 41. TCP 采用 3 次握手建立连接、4 次握手释放连接：会判断每次握手的 TCP报文段，尤其注意序号的变化

- 建立连接 (3次握手)
    - `Client` --> `SYN=1, Seq=x` --> `Server`
        - `Client` --> `SYN_SENT`
    - `Server` --> `SYN=1, ACK=1, Seq=y, Ack=x+1` --> `Client`
        - `Server` --> `SYN_RCVD`
    - `Client` --> `ACK=1, Seq=x+1, Ack=y+1` --> `Server`
        - `Client` --> `ESTABLISHED`
    - `Server` --> `ESTABLISHED`
- 释放连接 (4次挥手)
    - `Client` --> `FIN=1` --> `Server`
        - `Client` --> `FIN_WAIT_1`
    - `Server` --> `ACK=1` --> `Client`
        - `Client` --> `FIN_WAIT_2`(只能收不能发)
        - `Server` --> `CLOSE_WAIT`
    - `Server` --> `FIN=1` --> `Client`
        - `Server` --> `LAST_ACK`
    - `Client` --> `ACK=1` --> `Server`
        - `Client` --> `TIME_WAIT` (等待2MSL，通常2分钟。2分钟到，默认关闭连接)
        - `Server` --> `CLOSED`

## 大题的复习范围

### 1. 交换技术：电路交换、报文交换和分组交换，会计算总延迟时间，重点掌握分组交换技术

- 交换技术：实现任意两个节点间的通信
    - 电路交换：建立专用通信路径，通信期间独占，建立后无须存储转发
        - 总延迟 = 建立连接时间 + 传输时间 + 拆除连接时间
    - 报文交换：无须建立连接，数据+src/dst地址封装成报文，存储转发
        - 总延迟 = 各节点存储转发延迟之和 + 传输时间
    - 分组交换：将长报文划分为若干个固定长度或有限长度的分组（Packet），每个分组独立进行“存储-转发”
        - 总延迟 ≈ 各分组在各节点的排队、处理、传输和传播延迟之和
            - 传输延迟 = 分组长度 / 链路带宽
            - 传播延迟 = 链路长度 / 传播速度

### 2. 虚电路和数据报的工作原理

- 分组交换有两种实现方式：虚电路和数据报
    - 数据报：每个分组携带完整的源和目的地址，独立路由选择
        - 无连接，可能乱序到达
    - 虚电路：建立逻辑连接（虚电路），统一路由选择
        - 面向连接，按序到达
        - 每个分组只携带虚电路标识符（VCI）

### 3. 计算机网络的主要性能指标：带宽、时延、时延带宽积和利用率

- **带宽 (Bandwidth)**：通信线路允许通过的信号频带范围，在数字网络中指**最高数据率** (bit/s)。
- **时延 (Delay / Latency)**：
    - $D_{total} = D_{proc} + D_{queue} + D_{trans} + D_{prop}$
    - **处理时延** ($D_{proc}$)：节点检查头部、决定路由的时间。
    - **排队时延** ($D_{queue}$)：在输出队列等待的时间。
    - **传输时延** ($D_{trans}$)：将分组推向链路所需时间 = $L/R$ (分组长度/链路带宽)。
    - **传播时延** ($D_{prop}$)：信号在介质中传播的时间 = $d/s$ (距离/传播速度)。
- **时延带宽积**：$= \text{传播时延} \times \text{带宽}$。表示链路充满时的比特数（以比特为单位的链路长度）。
- **利用率**：
    - 信道利用率：有数据通过时间 / 总时间。
    - 网络利用率：全网络信道利用率的加权平均。利用率过高会导致时延急剧增加 ($D = D_0 / (1-U)$)。

### 4. 停-等协议的性能分析，例如：信道利用率

- 信道利用率：
    - $U = \frac{T_f}{T_f + 2T_{prop}}$
        - $T_f$：帧传输时间
        - $T_{prop}$：单程传播延迟
    - 平均重传次数：
        - $E[A] = \frac{1}{1-P_f}$
        - $P_f$：帧出错概率

### 5. 数据链路层全双工数据传输使用滑动窗口进行流量控制和差错控制：选择重发 ARQ 协议和后退 N 帧 ARQ 协议（可参考 PPT 中的课堂练习）

- **后退 N 帧 (GBN)**：
    - 接收窗口 $W_R = 1$。
    - 接收方若收到乱序帧（如收到0, 2，缺少1），丢弃2，发送ACK 0（期望1）。
    - 发送方超时后，重传 1 以及后续的 2, 3... (Go-Back-N)。
    - 优点：接收方简单。缺点：批量重传浪费带宽。
- **选择重发 (SR)**：
    - 接收窗口 $W_R > 1$。
    - 接收方缓存乱序帧，发送 SACK 或 NAK。
    - 发送方只重传超时的那一帧。
    - 优点：效率高。缺点：接收方复杂，需要排序缓存。

### 6. 滑动窗口协议中的帧序号比特数的计算，例如：后退 N 帧协议

- 若帧序号采用 $bit$ 位编码，则序号范围是 $0 \sim 2^{bit}-1$。
- **GBN**：发送窗口 $W_T \le 2^{bit} - 1$。如果不满足，接收方无法区分是新帧还是重传的旧帧。
    - 例：序号3位 (0-7)，则最大窗口为 7。
- **SR**：发送窗口 $W_T \le 2^{bit-1}$。
    - 例：序号3位 (0-7)，则最大窗口为 4。

### 7. IEEE802.11 MAC 协议中的 DCF，特别是信道预约：RTS/CTS，注意 IFS的使用，会计算总时延

- **DCF (分布式协调功能)**：基于 CSMA/CA。
- **IFS (帧间间隔)**：SIFS (短) < PIFS (PCF) < DIFS (DCF)。优先级越高，等待时间越短。
- **信道预约 (虚拟载波监听)**：
    - 源发送 **RTS** (Request To Send)，包含传输所需时长。
    - 目的回复 **CTS** (Clear To Send)，也包含时长。
    - 周围节点收到 RTS/CTS 后，设置 **NAV** (网络分配矢量)，在此时长内不竞争信道，解决隐蔽站问题。
- **过程与时延**：
    1.  DIFS -> RTS -> SIFS -> CTS -> SIFS -> DATA -> SIFS -> ACK。
    2.  若信道忙，由二进制指数退避算法选择退避时间。

### 8. 以太网的设计：不存在单故障点

- **无源电缆**：早期总线型以太网，电缆断裂导致全网瘫痪。
- **集线器/交换机**：星型拓扑。单根网线断裂只影响一台主机。
- **生成树协议 (STP)**：允许物理环路存在（提供冗余链路），但在逻辑上阻塞某些端口以消除环路。当主链路故障时，备用链路自动激活。

### 9. 流量整形技术：漏桶、令牌桶、令牌桶+漏桶（用途、算法、会计算各部分时间：突发、平稳、空闲）

[流量整形](./Note.md#服务质量qos)

- **漏桶 (Leaky Bucket)**：
    - 强行将输出速率限制为常量 $R$。
    - 突发流量会被缓存或丢弃。
    - 平滑流量，消除突发。
- **令牌桶 (Token Bucket)**：
    - 以恒定速率 $r$ 产生令牌，桶容量 $C$。
    - 每发送一个字节消耗一个令牌。有令牌才能发送。
    - **允许突发**：如果桶满，可以一次性发送 $C$ 大小的数据。
    - **最大突发时间计算**：设最大输出速率为 $M$ (链路物理带宽)，突发时间为 $S$。
        - 突发期间输出的数据量 = 桶内预存令牌 + 突发期间新产生令牌
        - $M \times S = C + r \times S$
        - $S = \frac{C}{M - r}$

### 10. 分组调度算法：重点掌握 WFQ（会计算各分组的输出次序）

- 加权公平队列（Weighted Fair Queuing, WFQ）
    - 现实中可能希望给某些流更高的优先级（如视频流）
    - 虚拟完成时间$F_i$：在理想的逐比特系统中，该包何时发送完毕
        - $F_i = \max(A_i, F_{i-1}) + \frac{L_i}{W}$
            - $A_i$：包$i$到达时间
            - $L_i$：包$i$长度（比特）
            - $W$：流的权重
        - $F_i$越小，优先级越高

### 11. 路由器、路由表和路由选择

- **结构**：
    - 输入端口：物理层接收 -> 数据链路层解封 -> 查找转发表 (排队)。
    - 交换结构：内存/总线/纵横式开关。将分组从输入传送到输出。
    - 输出端口：排队 (AQM, WFQ) -> 封装 -> 发送。
    - 路由选择处理器 (控制平面)：运行路由协议 (RIP/OSPF/BGP)，计算路由表。
- **路由表**：包含 (目的网络前缀, 下一跳地址, 接口)。
- **转发**：数据平面。根据IP包的目的地址，在转发表中查找最佳匹配项。

### 12. CIDR：重点掌握路由聚合和最长前缀匹配的使用，要会应用

- **CIDR (Classless Inter-Domain Routing，无类别域间路由)**：IP地址分配和路由聚合方法，消除了A/B/C类的界限，使用 `/n` 表示前缀长度。
- **路由聚合 (Supernetting)**：将多个连续的小网络前缀合并为一个大前缀，减少路由表项。
    - 方法：找共同前缀。
    - 例：`192.168.0.0/24` 和 `192.168.1.0/24` -> `192.168.0.0/23`。
- **最长前缀匹配**：查找路由表时，若有多个表项匹配目的IP，选择前缀最长（掩码最长，最具体）的一项。

### 13. RIP 协议、OSPF 协议和 BGP 协议所使用的路由算法、适用范围、封装在哪个协议的分组中进行传输

| 协议 | 算法 | 范围 | 数据包封装 |
| :--- | :--- | :--- | :--- |
| **RIP** | 距离向量 (DV) | IGP (自治系统内) - 小型 | UDP (端口520) |
| **OSPF** | 链路状态 (LS) | IGP - 大型 | IP (协议号89) |
| **BGP** | 路径向量 (Path Vector) | EGP (自治系统间) | TCP (端口179) |

### 14. 路由器和交换机的区别，以及如何配置他们的 IP 地址

| 区别 | 交换机 (二层) | 路由器 (三层) |
| :--- | :--- | :--- |
| **转发依据** | MAC 地址 | IP 地址 |
| **广播域** | 同一个 | 隔离 |
| **功能** | 组网，扩展接入 | 异构网络互联，路由 |

- **配置 IP**：
    - **路由器**：每个物理接口直接配置IP，作为一个网关。
        - `interface GigabitEthernet0/0` -> `ip address 192.168.1.1 255.255.255.0`
    - **二层交换机**：物理接口不配IP，配置在虚拟接口 (VLAN Interface / SVI) 上，用于管理。
        - `interface vlan 1` -> `ip address 192.168.1.2 255.255.255.0`

### 15. 隧道技术的应用（必须掌握隧道技术的原理）

- **原理**：将一种协议的数据包（乘客协议）封装在另一种协议的数据包（载体协议）的数据部分中进行传输。
- **应用**：
    1.  **IPv6 过渡**：IPv6 over IPv4。IPv6 报文作为 IPv4 的 Payload，穿过 IPv4 网络。
    2.  **VPN (虚拟专用网)**：私有网络数据加密后封装在公网IP包中。如 IPSec VPN, GRE 隧道。

### 16. TCP 中的拥塞控制（工作原理，会计算每轮的拥塞窗口和慢开始门限，注意区分慢开始和拥塞避免、快重传和快恢复两种方法）；特别注意：`发送窗口=Min[通知窗口,拥塞窗口]`

- **拥塞窗口 (cwnd)**：发送方维护的状态变量。
- **慢开始 (Slow Start)**：`cwnd = 1` MSS，每收到一个ACK，`cwnd`加倍 (指数增长)。直到 `cwnd >= ssthresh`。
- **拥塞避免 (Congestion Avoidance)**：`cwnd >= ssthresh` 后，每经过一个 RTT，`cwnd` 加 1 (线性增长)。
- **拥塞发生**：
    - **超时**：`ssthresh = cwnd/2`, `cwnd = 1`, 重新慢开始。
    - **3个重复ACK** (轻微拥塞)：执行 **快重传** (立即重传丢失报文) 和 **快恢复**。
- **快恢复 (Fast Recovery)**：
    - `ssthresh = cwnd/2`。
    - `cwnd = ssthresh + 3` (TCP Reno)。之后进入拥塞避免 (线性增长)。

## 补充知识点

### 使用 Wireshark 抓包分析

- **过滤器**：
    - 过滤IP：`ip.addr == 192.168.1.1`
    - 过滤协议：`http`, `tcp`, `dns`
    - 逻辑组合：`and`, `or`, `not`
- **流追踪**：Follow TCP Stream。
- **统计**：流量IO图，协议分级。

### 以太网数据帧格式、IP 数据报格式和 TCP 报文段格式

> 要求记住，专门考核

1.  **以太网帧 (Ethernet V2)**：
    - | 目的MAC (6) | 源MAC (6) | 类型 (2) | 数据 (46-1500) | FCS (4) |
    - **目的MAC地址**：6字节，表示帧的接收方MAC地址。可以是单播、组播或广播地址（FF:FF:FF:FF:FF:FF）。
    - **源MAC地址**：6字节，表示发送方MAC地址。
    - **类型字段**：2字节，标识上层协议类型。例如：
        - `0x0800`：IPv4
        - `0x0806`：ARP
        - `0x86DD`：IPv6
    - **数据字段**：46~1500字节，承载上层协议的数据。若数据不足46字节需填充（Padding）补齐。
    - **FCS（帧校验序列）**：4字节，用于差错检测（CRC）。
    - **最小帧长**：64字节（包括所有字段），防止CSMA/CD下冲突无法检测。
    - **最大帧长**：1518字节（不含VLAN Tag），超出为巨型帧（Jumbo Frame）。
    - **帧结构示意**：
        | 目的MAC | 源MAC | 类型 | 数据 | FCS |
        |:-------:|:-----:|:----:|:----:|:---:|
        | 6B      | 6B    | 2B   | 46~1500B | 4B |
    - **应用**：以太网交换机根据目的MAC地址进行帧转发，广播帧用于地址解析（如ARP）。

2.  **IP 数据报 (IPv4)**：
    - | 版本/首部长度/服务类型/总长度 |
    - | 标识/标志/片偏移 |
    - | TTL/协议/首部校验和 |
    - | 源 IP 地址 (32位) |
    - | 目的 IP 地址 (32位) |
    - **版本**：4位，当前为IPv4（值为4）。
    - **首部长度**：4位，单位为4字节，通常为5（即20字节）。
    - **服务类型（TOS）**：8位，区分服务优先级（如DSCP）。
    - **总长度**：16位，整个IP数据报长度（含首部和数据），最大65535字节。
    - **标识**：16位，分片时用于唯一标识数据报。
    - **标志**：3位，DF（禁止分片）、MF（更多分片）、保留位。
    - **片偏移**：13位，分片数据在原报文中的偏移，单位为8字节。
    - **TTL（生存时间）**：8位，每经过一个路由器减1，防止环路。
    - **协议号**：8位，指明上层协议类型：
        - `6`：TCP
        - `17`：UDP
        - `1`：ICMP
    - **首部校验和**：16位，仅校验IP首部。
    - **源IP地址**：32位，发送方IP。
    - **目的IP地址**：32位，接收方IP。
    - **选项字段**：可选，通常不用。
    - **数据字段**：承载上层协议数据（如TCP/UDP）。
    - **分片与重组**：路由器可分片，重组仅在目的主机完成。
    - **格式示意**：
        | 版本 | 首部长度 | 服务类型 | 总长度 | 标识 | 标志 | 片偏移 | TTL | 协议 | 校验和 | 源IP | 目的IP | 数据 |
        |:----:|:--------:|:--------:|:------:|:----:|:----:|:-------:|:---:|:----:|:------:|:----:|:------:|:----:|
        | 4b   | 4b       | 8b       | 16b    | 16b  | 3b   | 13b     | 8b  | 8b   | 16b    | 32b  | 32b    | ...  |

3.  **TCP 报文段**：
    - | 源端口 (16) | 目的端口 (16) |
    - | 序号 (32) |
    - | 确认号 (32) |
    - | 数据偏移/保留/标志位 (URG/ACK/PSH/RST/SYN/FIN) | 窗口 (16) |
    - | 校验和 (16) | 紧急指针 (16) |
    - **源端口/目的端口**：各16位，标识通信双方的应用进程。
    - **序号**：32位，表示本报文段第一个字节的数据序号，实现可靠传输和乱序重组。
    - **确认号**：32位，期望收到对方下一个字节的序号，实现确认应答。
    - **数据偏移**：4位，TCP首部长度（单位4字节）。
    - **保留位**：6位，暂未使用。
    - **标志位**：6位，控制TCP连接状态：
        - URG：紧急指针有效
        - ACK：确认号有效
        - PSH：接收方应尽快交付数据
        - RST：重置连接
        - SYN：同步序号，用于建立连接
        - FIN：释放连接
    - **窗口大小**：16位，接收方通告的可用缓冲区（流量控制）。
    - **校验和**：16位，覆盖TCP首部和数据，含伪首部（源/目的IP、协议号等），用于差错检测。
    - **紧急指针**：16位，指示紧急数据结束位置。
    - **选项字段**：如MSS、窗口扩大因子、时间戳等。
    - **数据字段**：实际传输的数据。
    - **长度计算**：TCP数据长度 = IP总长度 - IP首部长度 - TCP首部长度。
    - **三次握手/四次挥手**：通过SYN/ACK/FIN等标志位实现连接建立与释放。
    - **格式示意**：
        | 源端口 | 目的端口 | 序号 | 确认号 | 数据偏移 | 保留 | 标志 | 窗口 | 校验和 | 紧急指针 | 选项 | 数据 |
        |:------:|:--------:|:----:|:------:|:--------:|:----:|:----:|:----:|:------:|:--------:|:----:|:----:|
        | 16b    | 16b      | 32b  | 32b    | 4b       | 6b   | 6b   | 16b  | 16b    | 16b      | ...  | ...  |

---

以上不是所有的考核知识点，如需好成绩还需系统复习！
